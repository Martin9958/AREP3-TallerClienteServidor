importArticle({type:'script',article:'u:dev:MediaWiki:AjaxRC.js'});;(function(window,$,mw){'use strict';var buttonStart=typeof window.BackToTopStart==='number'?window.BackToTopStart:window.innerHeight,scrollSpeed=typeof window.BackToTopSpeed==='number'?window.BackToTopSpeed:600,fadeSpeed=typeof window.BackToTopFade==='number'?window.BackToTopFade:600,$button,cc=mw.config.get('wgSassParams')['color-community-header'],theme;if(window.BackToTopLoaded){return;}window.BackToTopLoaded=!0;function init(){$button.children('div').hide();$(window).scroll($.throttle(100,function(){if($(this).scrollTop()>buttonStart){switch(fadeSpeed){case 0:$button.children('div').show();break;default:$button.children('div').fadeIn(fadeSpeed);break;}}else{switch(fadeSpeed){case 0:$button.children('div').hide();break;default:$button.children('div').fadeOut(fadeSpeed);break;}}}));mw.hook('dev.BackToTopButton').fire($button);}function click(){$('body, html').animate({scrollTop:0},scrollSpeed);return false;}
function modernPreload(l){if(++_loaded==l){modernInit(window.dev.wds,window.dev.colors);}}function modernInit(wds,colors){cc=colors.parse(cc);theme=cc.isBright()?'#000000':'#ffffff';cc=cc.hex();$button=$('<div>',{id:'BackToTopBtn',append:[$('<div>',{css:{background:cc,color:theme,},'html':wds.icon('menu-control')})],click:click}).appendTo(document.body);$.proxy(modernReposition,$button.children('div'))();$(window).on('resize',$.throttle(100,$.proxy(modernReposition,$button.children('div'))));init();}function modernReposition(){this.css({'right':$(window).width()/100*5,'bottom':$('#WikiaBar #WikiaBarWrapper').height()+8});}function arrowInit(){$button=$('<li>',{click:click,id:'backtotop'}).append($('<img>',{src:'https://images.wikia.nocookie.net/dev/images/'+((theme==='black'||window.BackToTopArrowBlack)?'f/f2/BlackToTopArrow':'c/c3/BackToTopArrow_white')+'.png'})).appendTo('#WikiaBarWrapper .toolbar > .tools');init();}function oldInit(i18n){$button=$('<li>',{click:click,id:'backtotop'}
).append($('<button>',{css:{height:'20px'},type:'button',text:(typeof window.BackToTopText==='string'&&window.BackToTopText)||i18n.msg('backToTop').plain()})).appendTo('#WikiaBarWrapper .toolbar > .tools');init();}if(window.BackToTopModern){var _loaded=0;[{h:'wds',s:'u:dev:WDSIcons/code.js'},{h:'colors',s:'u:dev:Colors/code.js'}].forEach(function(lib,i,a){importArticle({type:'script',article:lib.s});mw.hook('dev.'+lib.h).add($.proxy(modernPreload,null,a.length));});}else if(window.BackToTopArrow){arrowInit();}else{importArticle({type:'script',article:'u:dev:MediaWiki:I18n-js/code.js'});mw.hook('dev.i18n').add(function(i18n){i18n.loadMessages('BackToTopButton').done(oldInit);});}importArticle({type:'style',article:'u:dev:MediaWiki:BackToTopButton.css'});}(this,jQuery,mediaWiki));;;(function(module,mw,$,undefined){'use strict';var translations=$.extend(true,{ar:{and:'و',second:'ثانية',seconds:'ثواني',minute:'دقيقة',minutes:'دقائق',hour:'ساعة',hours:'ساعات',
day:'يوم',days:'أيام'},be:{and:'і',second:'секунда',seconds:'секунд',minute:'хвіліна',minutes:'хвілін',hour:'гадзіну',hours:'гадзін',day:'дзень',days:'дзён'},ca:{and:'i',second:'segon',seconds:'segons',minute:'minut',minutes:'minuts',hour:'hora',hours:'hores',day:'dia',days:'dies'},de:{and:'und',second:'Sekunde',seconds:'Sekunden',minute:'Minute',minutes:'Minuten',hour:'Stunde',hours:'Stunden',day:'Tag',days:'Tage'},en:{and:'and',second:'second',seconds:'seconds',minute:'minute',minutes:'minutes',hour:'hour',hours:'hours',day:'day',days:'days'},el:{and:'και',second:'δευτερόλεπτο',seconds:'δευτερόλεπτα',minute:'λεπτό',minutes:'λεπτά',hour:'ώρα',hours:'ώρες',day:'ημέρα',days:'ημέρες'},es:{and:'y',second:'segundo',seconds:'segundos',minute:'minuto',minutes:'minutos',hour:'hora',hours:'horas',day:'día',days:'días'},fr:{and:'et',second:'seconde',seconds:'secondes',minute:'minute'
,minutes:'minutes',hour:'heure',hours:'heures',day:'jour',days:'jours'},hu:{and:'és',second:'másodperc',seconds:'másodperc',minute:'perc',minutes:'perc',hour:'óra',hours:'óra',day:'nap',days:'nap'},id:{and:'dan',second:'detik',seconds:'detik',minute:'menit',minutes:'menit',hour:'jam',hours:'jam',day:'hari',days:'hari'},it:{and:'e',second:'secondo',seconds:'secondi',minute:'minuto',minutes:'minuti',hour:'ora',hours:'ore',day:'giorno',days:'giorni'},ja:{and:'',second:'秒',seconds:'秒',minute:'分',minutes:'分',hour:'時間',hours:'時間',day:'日',days:'日'},ms:{and:'dan',second:'saat',seconds:'saat',minute:'minit',minutes:'minit',hour:'jam',hours:'jam',day:'hari',days:'hari'},nl:{and:'en',second:'seconde',seconds:'seconden',minute:'minuut',minutes:'minuten',hour:'uur',hours:'uur',day:'dag',days:'dagen'},pl:{and:'i',second:'sekunda',seconds:'sekund(y)',minute:'minuta',minutes:'minut(y)',hour:'godzina',hours:'godzin(y)',day:'dzień',days:'dni'},pt:{and:'e',second:'segundo',
seconds:'segundos',minute:'minuto',minutes:'minutos',hour:'hora',hours:'horas',day:'dia',days:'dias'},'pt-br':{and:'e',second:'segundo',seconds:'segundos',minute:'minuto',minutes:'minutos',hour:'hora',hours:'horas',day:'dia',days:'dias'},ro:{and:'și',second:'secundă',seconds:'secunde',minute:'minut',minutes:'minute',hour:'oră',hours:'ore',day:'zi',days:'zile',},ru:{and:'и',second:'секунда',seconds:'секунд',minute:'минута',minutes:'минут',hour:'час',hours:'часов',day:'день',days:'дней'},sr:{and:'i',second:'sekundu',seconds:'sekunde/-i',minute:'minutu',minutes:'minute/-a',hour:'sat',hours:'sata/-i',day:'dan',days:'dana'},tl:{and:'at',second:'segundo',seconds:'mga segundo',minute:'minuto',minutes:'mga minuto',hour:'oras',hours:'mga oras',day:'araw',days:'mga araw'},tr:{and:'ve',second:'saniye',seconds:'saniye',minute:'dakika',minutes:'dakika',hour:'saat',hours:'saat',day:'gün',days:'gün'},uk:{and:'та',second:'секунда',seconds:
'секунд',minute:'хвилина',minutes:'хвилин',hour:'годину',hours:'годин',day:'день',days:'днів'},vi:{and:'và',second:'giây',seconds:'giây',minute:'phút',minutes:'phút',hour:'giờ',hours:'giờ',day:'ngày',days:'ngày'},zh:{and:' ',second:'秒',seconds:'秒',minute:'分',minutes:'分',hour:'时',hours:'时',day:'天',days:'天'},'zh-tw':{and:' ',second:'秒',seconds:'秒',minute:'分',minutes:'分',hour:'時',hours:'時',day:'天',days:'天'},'zh-hk':{and:' ',second:'秒',seconds:'秒',minute:'分',minutes:'分',hour:'時',hours:'時',day:'天',days:'天'}},module.translations||{}),i18n=translations[mw.config.get('wgContentLanguage')]||translations.en;var countdowns=[];var NO_LEADING_ZEROS=1,SHORT_FORMAT=2,NO_ZEROS=4;function output(i,diff){var delta,result,parts=[];delta=diff%60;result=' '+i18n[delta===1?'second':'seconds'];if(countdowns[i].opts&SHORT_FORMAT)result=result.charAt(1);parts.unshift(delta+result);diff=Math.floor(diff/60);delta=
diff%60;result=' '+i18n[delta===1?'minute':'minutes'];if(countdowns[i].opts&SHORT_FORMAT)result=result.charAt(1);parts.unshift(delta+result);diff=Math.floor(diff/60);delta=diff%24;result=' '+i18n[delta===1?'hour':'hours'];if(countdowns[i].opts&SHORT_FORMAT)result=result.charAt(1);parts.unshift(delta+result);diff=Math.floor(diff/24);result=' '+i18n[diff===1?'day':'days'];if(countdowns[i].opts&SHORT_FORMAT)result=result.charAt(1);parts.unshift(diff+result);result=parts.pop();if(countdowns[i].opts&NO_LEADING_ZEROS){while(parts.length&&parts[0][0]==='0'){parts.shift();}}if(countdowns[i].opts&NO_ZEROS){parts=parts.filter(function(part){return part[0]!=='0';});}if(parts.length){if(countdowns[i].opts&SHORT_FORMAT){result=parts.join(' ')+' '+result;}else{result=parts.join(', ')+' '+i18n.and+' '+result;}}countdowns[i].node.text(result);}function end(i){var c=countdowns[i].node.parent();switch(c.attr('data-end')){case'remove':c.remove();return true;case'stop':output(i,0);return true;case'toggle'
:var toggle=c.attr('data-toggle');if(toggle&&toggle=='next'){c.next().css('display','inline');c.css('display','none');return true;}if(toggle&&$(toggle).length){$(toggle).css('display','inline');c.css('display','none');return true;}break;case'callback':var callback=c.attr('data-callback');if(callback&&$.isFunction(module[callback])){output(i,0);module[callback].call(c);return true;}break;}countdowns[i].countup=!0;output(i,0);return false;}function update(){var now=Date.now();var countdownsToRemove=[];$.each(countdowns.slice(0),function(i,countdown){var diff=Math.floor((countdown.date-now)/1000);if(diff<=0&&!countdown.countup){if(end(i))countdownsToRemove.push(i);}else{output(i,Math.abs(diff));}});var x;while((x=countdownsToRemove.pop())!==undefined){countdowns.splice(x,1);}if(countdowns.length){window.setTimeout(function(){update();},1000);}}function getOptions(node){var text=node.parent().attr('data-options'),opts=0;if(text){if(/no-leading-zeros/.test(text)){opts|=NO_LEADING_ZEROS;}
if(/short-format/.test(text)){opts|=SHORT_FORMAT;}if(/no-zeros/.test(text)){opts|=NO_ZEROS;}}return opts;}function init(){var countdown=$('.countdown:not(.handled)');if(!countdown.length)return;$('.nocountdown').css('display','none');countdown.css('display','inline').find('.countdowndate').each(function(){var $this=$(this),date=(new Date($this.text())).valueOf();if(isNaN(date)){$this.text('BAD DATE');return;}countdowns.push({node:$this,opts:getOptions($this),date:date,});});countdown.addClass('handled');if(countdowns.length){update();}}mw.hook('wikipage.content').add(init);}(window.countdownTimer=window.countdownTimer||{},mediaWiki,jQuery));;(function(module,$,mw){'use strict';if(!$('#UserProfileMasthead').exists()||window.InactiveUsersLoaded){return;}window.InactiveUsersLoaded=!0;if(!Date.prototype.toISOString)Date.prototype.toISOString=function(){function pad(s){return(s+='').length<2?'0'+s:s;}return this.getUTCFullYear()+'-'+pad(this.getUTCMonth()+1)+'-'+pad(this.getUTCDate())+'T'
+pad(this.getUTCHours())+':'+pad(this.getUTCMinutes())+':'+pad(this.getUTCSeconds())+'.'+(this.getUTCMilliseconds()/1000).toFixed(3).substr(-3)+'Z';};function isoDateNDaysAgo(days){return new Date(Date.now()-days*24*60*60*1000).toISOString();}module=$.extend({text:'inactive',gone:[],months:3},module);var user=$('#UserProfileMasthead h1[itemprop="name"]').text();mw.loader.using('mediawiki.api').then(function(){new mw.Api().get({action:'query',list:'usercontribs|users',uclimit:1,ucprop:'title|timestamp',ucuser:user,ucstart:isoDateNDaysAgo(0),ucend:isoDateNDaysAgo(30*Math.max(parseInt(module.months,10)||1,1)),ususers:user,usprop:'gender'}).done(function(result){if(result&&result.query&&result.query.users&&result.query.users[0]&&((result.query.usercontribs&&!result.query.usercontribs.length)||module.gone.indexOf(user)!==-1)){var gender=result.query.users[0].gender||'unknown',$container=$('#UserProfileMasthead hgroup'),css=$container.find('.tag').length?{marginLeft:'10px'}:{},text=typeof
module.text==='string'?module.text:typeof module.text==='object'?typeof module.text[gender]==='string'?module.text[gender]:module.text.unknown:'inactive';$container.append($('<span>',{'class':'tag inactive-user','css':css,text:text}));mw.hook('dev.inactiveusers').fire();}});});}(window.InactiveUsers=window.InactiveUsers||{},jQuery,mediaWiki));;window.dev=window.dev||{};dev.ReferencePopups=dev.ReferencePopups||{};dev.ReferencePopups.unload=dev.ReferencePopups.unload||function(){"use strict";delete this.Popup;delete this.configure;if(this.unloadCore){this.unloadCore();}};(function(module,lang){"use strict";var i18n={en:{coreConfigureText:'Configure Reference Popups',coreConfigureHover:'Change settings for Reference Popups'},ar:{coreConfigureText:'اضبط تلميحات المراجع',coreConfigureHover:'اضبط إعدادات تلميح المراجع'},be:{coreConfigureText:'Налада усплываючых падказак',coreConfigureHover:
'Змяніць налады усплываючых падказак'},ca:{coreConfigureText:'Configura referències emergents',coreConfigureHover:'Canviar la configuració de referències emergents'},de:{coreConfigureText:'Referenz-Popups konfigurieren',coreConfigureHover:'Einstellungsänderungen für Referenz-Popups'},el:{coreConfigureText:'Ρύθμιση Αναδυόμενων Αναφορών',coreConfigureHover:'Αλλαγή ρυθμίσεων για τις Αναδυόμενες Αναφορές'},es:{coreConfigureText:'Configurar popups de referencias',coreConfigureHover:'Modificar la configuración de los popups de referencias'},fr:{coreConfigureText:'Configurer Popups de Référence',coreConfigureHover:'Modifier les préférences pour les Popups de Référence'},it:{coreConfigureText:'Configura le note a popup',coreConfigureHover:'Cambia le impostazioni per le note a popup'},ja:{coreConfigureText:'注釈ふきだしの設定',coreConfigureHover:
'注釈ふきだしの設定を変更する'},ko:{coreConfigureText:'주석 말풍선 설정',coreConfigureHover:'주석 말풍선 설정하기'},nl:{coreConfigureText:'Configureer Referentie Popups',coreConfigureHover:'Wijzig de instellingen voor Referentie Popups'},pl:{coreConfigureText:'Skonfiguruj wyskakujące przypisy',coreConfigureHover:'Zmień ustawienia dla wyskakujących przypisów'},'pt-br':{coreConfigureText:'Configurar Popups de Referência',coreConfigureHover:'Mudar configurações para Popups de Referência'},ro:{coreConfigureText:'Configurați popupurile de referință',coreConfigureHover:'Schimbă setările pentru popupurile de referință'},ru:{coreConfigureText:'Настройка всплывающих подсказок',coreConfigureHover:'Изменить настройки всплывающих подсказок'},tr:{coreConfigureText:'Referans Bildirimlerini Yapılandır',coreConfigureHover:'Referans Bildirimleri\'nin seçeneklerini değiştir'},uk:{
coreConfigureText:'Налаштування спливаючих підказок',coreConfigureHover:'Змінити налаштування спливаючих підказок'},vi:{coreConfigureText:'Thiết Đặt Popup Tham Khảo',coreConfigureHover:'Thay đổi thiết đặt cho Popup Tham Khảo'},zh:{coreConfigureText:'设定参考资料弹窗',coreConfigureHover:'更改参考弹出窗口的设置'},'zh-hk':{coreConfigureText:'設定參考資料彈窗',coreConfigureHover:'更改參考彈出窗口的設置'},'zh-tw':{coreConfigureText:'設定參考資料彈窗',coreConfigureHover:'更改參考彈出窗口的設置'}};var msg=module.messages=module.messages||{};for(var m in i18n.en){msg[m]=msg[m]||(i18n[lang]&&i18n[lang][m])||i18n.en[m];}})(dev.ReferencePopups,mediaWiki.config.get('wgUserLanguage'));(function(window,$,mw){"use strict";var module=window.dev.ReferencePopups;if(module.Popup){return $.noop;}var mwReady=$.Deferred(),mwDeps=['jquery.ui.position',
'jquery.effects.fold','jquery.ui.core','jquery.ui.widget'];mw.loader.load(mwDeps,null,true);mw.loader.using(mwDeps,mwReady.resolve,mwReady.reject);var colors=window.dev.colors||$.ajax({url:mw.config.get('wgLoadScript'),data:{mode:'articles',only:'scripts',articles:'u:dev:Colors/code.js'},dataType:'script',cache:!0});if(!module.cssLoaded){window.importArticle({type:'style',article:'u:dev:MediaWiki:ReferencePopups.css'});module.cssLoaded=!0;}var dfd=$.Deferred();module.Popup=dfd.promise();return function(callback){$.when(mwReady,colors).done(function(){dfd.resolve(module.Popup=callback(module,window,$,mw,window.dev.colors));}).fail(function(){delete module.Popup;dfd.reject();});};}(window,jQuery,mediaWiki))(function(module,window,$,mw,Colors){"use strict";$.curCSS=$.curCSS||$.css;(function(color,Colors,mw,$){function ifOk(val,alt){return(val&&val!=='transparent'&&val!=='rgba(0, 0, 0, 0)')?val:alt;}function tryParse(val,alt){try{return Colors.parse(val);}catch(e){if(window.console){
window.console.warn('Colors Parse Error ('+val+'): ',e,e.stack);}return Colors.parse(alt);}}function toRgba(color,alpha){return'rgba('+color.red()+','+color.green()+','+color.blue()+','+alpha+')';}if(mw.config.get('skin')==='oasis'){color.page=Colors.parse(Colors.wikia.page);color.pageBorder=Colors.parse(Colors.wikia.border);color.accent=Colors.parse(Colors.wikia.menu);color.popText=Colors.wikia.text;}else{var $content=$('#content');color.page=tryParse(ifOk($('#globalWrapper').css('backgroundColor'),$content.css('backgroundColor')),'white');color.pageBorder=tryParse(ifOk($content.css('borderLeftColor'),$content.css('borderRightColor')),'#AAA');color.accent=tryParse(ifOk($('#footer').css('borderTopColor'),$('body').css('backgroundColor')),'#fabd23');color.popText=tryParse($('#mw-content-text').css('color'),'black');}var mixCol;if(color.page.isBright()){color.back=color.page.mix(mixCol='black',95).mix('blue',97);}else{color.back=color.page.mix(mixCol='white',95);}color.popEdge=color.
accent.mix(color.pageBorder,90);color.backA=toRgba(color.back,0.95);color.backB=toRgba(color.back.mix(mixCol,99),0.95);color.backC=toRgba(color.back.mix(mixCol,97),0.95);Colors.css('\
	.refpopups-box {\
		background-color: $back;\
		color: $popText;\
		border-color: $popEdge;\
		background: -webkit-linear-gradient(30deg, $backA, $backB 15%, $backB 25%, $backA 40%, $backA 50%, $backB 60%, $backB 70%, $backC 70%, $backC 90%, $backA 92%);\
		background: linear-gradient(60deg, $backA, $backB 15%, $backB 25%, $backA 40%, $backA 50%, $backB 60%, $backB 70%, $backC 70%, $backC 90%, $backA 92%);\
	}\
	.refpopups-chevron-in {\
		border-top-color: $back;\
		border-top-color: $backA;\
	}\
	.refpopups-flipped > .refpopups-chevron-in {\
		border-bottom-color: $back;\
		border-bottom-color: $backA;\
	}\
	.refpopups-chevron-out {\
		border-top-color: $popEdge;\
	}\
	.refpopups-flipped > .refpopups-chevron-out {\
		border-bottom-color: $popEdge;\
	}',color);})(module.colors=module.colors||{},Colors,mw
,$);var widgetId=0;$.widget('Lunarity.referencePopup',{options:{activateBy:'hover',hoverDelay:200,content:'',disabled:!1,visible:!1,animation:'fold',animSpeed:300,context:null,escapeCloses:!0,extraClass:'',contentBoxClass:'',stickyHover:!1,open:null,close:null},_create:function(){if(!this.document){this.document=$(this.element[0].ownerDocument);this.window=$(this.document[0].defaultView||this.document[0].parentWindow);this.eventNamespace='.'+this.widgetBaseClass+widgetId++;}this._timeouts={};this._$popup=$('<div class="refpopups-popup" id="'+this.eventNamespace.substr(1)+'">'+'<div class="refpopups-chevron-out"></div>'+'<div class="refpopups-chevron-in"></div>'+'<div class="refpopups-box">'+'</div></div>').addClass(this.options.extraClass).find('> .refpopups-box').addClass(this.options.contentBoxClass).end();this.options.context=$(this.document.find(this.options.context)[0]);if(!this.options.context.length){this.options.context=$(this.document[0].body);}this._setOption(
'activateBy',this.options.activateBy==='click'?'click':'hover');this._updateContent();if(!this.options.disabled){this.options.disabled=!0;this.enable();}if(this.options.visible){this.options.visible=!1;this.show();}},_clearTimeout:function(name){if(this._timeouts[name]!==null){window.clearTimeout(this._timeouts[name]);this._timeouts[name]=null;}},_setTimeout:function(name,callback,delay){this._clearTimeout(name);var me=this;this._timeouts[name]=window.setTimeout(function(){me._timeouts[name]=null;callback.call(me);},delay||0);},_installEvents:function(){var self=this,map,ns=this.eventNamespace;this._$popup.off(ns);this.element.off(ns);this._clearTimeout('open');this._clearTimeout('close');if(this.options.disabled){return;}if(this.options.activateBy==='hover'){map={};map['mouseenter'+ns]=function(){self._clearTimeout('close');};map['mouseleave'+ns]=function(ev){self._setTimeout('close',function(){this.hide(ev);},self.options.hoverDelay);};this._$popup.on(map);map={};map[
'mouseenter'+ns]=function(ev){self._clearTimeout('close');self._setTimeout('open',function(){this.show(ev);},self.options.hoverDelay);};map['mouseleave'+ns]=function(ev){self._clearTimeout('open');if(!self.options.stickyHover){self._setTimeout('close',function(){this.hide(ev);},self.options.hoverDelay);}};this.element.on(map);}var lastTouch;map={};map['touchEnd'+ns]=function(ev){lastTouch=ev.originalEvent;};map['click'+ns]=function(ev){if((self.options.activateBy!=='click'&&(!lastTouch||lastTouch.defaultPrevented))||self.options.disabled){return;}lastTouch=null;if(!self.options.visible){ev.preventDefault();self.show(ev);}else{self.hide(ev);}};if(this.options.escapeCloses){var onKeyUp=function(ev){if(ev.which===$.ui.keyCode.ESCAPE){self.hide(ev);}};map['keyup'+ns]=onKeyUp;this._$popup.on('keyup'+ns,onKeyUp);}this.element.on(map);map=null;},triggerHover:function(event){if(this.options.activateBy==='hover'){this._setTimeout('open',function(){this.show(event);},this.options.hoverDelay);}},
destroy:function(){this.hide();this._$popup.remove();this.element.off(this.eventNamespace);return $.Widget.prototype.destroy.call(this);},_updateContent:function(val){val=val||this.options.content||'';if(!val.jquery&&!val.nodeType){this.options.content=val=$($(this.document[0].createElement('div')).html(val).contents().unwrap());}this._$popup.find('> .refpopups-box').empty().append(val);},_describeAria:function(yes){var k='aria-describedby',val=this.element.attr(k),s=val?val.split(/\s+/g):[],id=this._$popup[0].id,at=$.inArray(id,s);if(at!==-1){if(!yes){s.splice(at,1);}}else if(yes){s.push(id);}val=s.join(' ');this.element[val?'attr':'removeAttr'](k,val);},show:function(event){if(this.options.visible||this.options.disabled){return;}this.options.context.append(this._$popup.stop(true,true));this._positionPopup();this._describeAria(true);if(this.options.animation){this._$popup.hide().show(this.options.animation,this.options.animSpeed);}var triggered=0,self=this,ns=this.eventNamespace;this.
window.on('scroll'+ns+' resize'+ns,function adaptCallback(){if(++triggered!==1){return;}self._positionPopup();window.setTimeout(function(){var t=triggered;triggered=0;if(t>1&&self.options.visible){adaptCallback();}},100);});if(this.options.activateBy==='click'){this.document.on('click'+ns,function(ev){if(!$(ev.target).closest(self._$popup.add(self.element)).length){self.hide();}});}this.options.visible=!0;this._trigger('open',event);},hide:function(event){if(!this.options.visible){return;}this.document.off(this.eventNamespace);this.window.off(this.eventNamespace);if(this.options.animation){var $clone=this._$popup.clone();this._$popup.after($clone);$clone.hide(this.options.animation,this.options.animSpeed,function(){$clone.remove();});}this._$popup.detach();this._describeAria(false);this.options.visible=!1;this._trigger('close',event);},toggle:function(yesno){yesno=(yesno!==void 0?yesno:!this.options.visible);this[yesno?'show':'hide']();},_setOption:function(key,val){switch(key){
case'disabled':if(val&&this.options.visible){this.hide();}this.options.disabled=!!val;this._installEvents();return;case'visible':this[val?'show':'hide']();return;case'activateBy':if(({hover:1,click:1})[val]===1){this.options.activateBy=val;this._installEvents();}return;case'content':this.options.content=val;this._updateContent();return;case'context':return;case'extraClass':this._$popup[0].className='refpopups-popup';this._$popup.addClass(val);break;case'extraBoxClass':this._$popup.find('> .refpopups-box').prop('className','refpopups-box').addClass(val);break;}return $.Widget.prototype._setOption.call(this,key,val);},_positionPopup:function(){var $popup=this._$popup.removeClass('refpopups-flipped'),$this=this.element,$chevOut=$popup.find('> .refpopups-chevron-out'),chevOutHeight=0;if($chevOut.is(':visible')){chevOutHeight=$chevOut.position().top+$chevOut.outerHeight()-$popup.outerHeight();}$popup.position({my:'bottom',at:'top',of:$this,collision:'fit none',offset:'0 -'+chevOutHeight});
var spaceAtTop=$this.offset().top,spaceAtBottom=spaceAtTop+$this[0].offsetHeight,popupHeight=$popup[0].offsetHeight+chevOutHeight,scroll=this.window.scrollTop();spaceAtTop=spaceAtTop-scroll;spaceAtBottom=(scroll+this.window.height())-spaceAtBottom;if(spaceAtTop<popupHeight&&spaceAtTop<spaceAtBottom){$popup.addClass('refpopups-flipped').position({my:'top',at:'bottom',of:$this,collision:'fit none',offset:'0 '+chevOutHeight});}if(!chevOutHeight){return;}var $chevIn=$popup.find('> .refpopups-chevron-in'),myLoc=$this.offset().left-$popup.offset().left+$this.outerWidth()/2;$chevOut.css('left',(myLoc-$chevOut.outerWidth()/2)+'px');$chevIn.css('left',(myLoc-$chevIn.outerWidth()/2)+'px');}});return $.Lunarity.referencePopup;});(function(window,$){"use strict";var module=window.dev.ReferencePopups;if(module.unloadCore){return $.noop;}module.unloadCore=$.noop;return function(callback){$.when(module.Popup).done(function(){callback(module,window,$,window.mediaWiki);}).fail(function(){delete module.
unloadCore;});};}(window,jQuery))(function(module,window,$,mw){"use strict";var store={get:function(key){try{return JSON.parse(window.localStorage.getItem(key));}catch(e){return null;}},set:function(key,data){try{window.localStorage.setItem(key,JSON.stringify(data));}catch(e){}}};var userConfig=(function(config,defaults){if(typeof(config)!=='object'||config===null){config={};}if(({hover:1,click:1})[config.react]!==1){config.react='hover';}config.hoverDelay=config.hoverDelay||defaults.hoverDelay||200;config.animate=(config.animate===void 0?defaults.animate===void 0||defaults.animate:!!config.animate);config.disabled=!!config.disabled&&!module.lockdown;config.stick=(config.stick===void 0?defaults.stick!==void 0&&defaults.stick:!!config.stick);return config;})(store.get('RefPopupsJS'),module.defaults||{});var armedPop=null,openPop=null;function cyclePopup(newTarget){if(openPop&&openPop.element.is(newTarget)){return;}if(armedPop){if(armedPop.element.is(newTarget)){return;}armedPop.destroy(
);}return(armedPop=constructPopup($(newTarget)));}function cleanupPopups(){if(openPop){openPop.destroy();}if(armedPop){armedPop.destroy();}openPop=armedPop=null;}$(function($){var lastTouch;$('#mw-content-text').on({'touchEnd.RefPopups':function(ev){lastTouch=ev.originalEvent;},'click.RefPopups':function(ev){if(((!lastTouch||lastTouch.defaultPrevented)&&userConfig.react!=='click')||userConfig.disabled){return;}lastTouch=null;var pop=cyclePopup(this);if(pop){ev.preventDefault();pop.show(ev);}},'referencepopupopen.RefPopups':function(){if(!armedPop||!armedPop.element.is(this)){return;}var oldOpen=openPop;openPop=armedPop;armedPop=null;if(oldOpen){oldOpen.destroy();}},'referencepopupclose.RefPopups':function(){if(!openPop||!openPop.element.is(this)){return;}if(armedPop){openPop.destroy();}else{armedPop=openPop;}openPop=null;}},'.reference');$(window).on('pagehide.RefPopups',cleanupPopups);applyHoverEvents();});function applyHoverEvents(){var $article=$('#mw-content-text');$article.off(
'mouseenter.RefPopups');if(userConfig.disabled){return;}if(userConfig.react!=='hover'){if(openPop){openPop.option('activateBy','click');}if(armedPop){armedPop.option('activateBy','click');}return;}$article.on('mouseenter.RefPopups','.reference',function(){var pop=cyclePopup(this);if(pop){pop.triggerHover();}});if(openPop){openPop.option('activateBy','hover');}if(armedPop){armedPop.option('activateBy','hover');}}if(!module.lockdown){$(function($){$('#articleCategories, #catlinks').first().after($('<a href="#configure-refpopups" class="refpopups-configure-page" />').html('['+module.messages.coreConfigureText+']').click(onClickConfigure).appendTo(this));});}module.unloadCore=function(){$('#mw-content-text').off('.RefPopups');$(window).off('.RefPopups');$('a[href="#configure-refpopups"]').remove();cleanupPopups();delete this.unloadCore;};$(window).trigger('dev-ReferencePopups-config',module.settings=$.extend({},userConfig));var configureIsPending=!1;function onClickConfigure(ev){ev.
preventDefault();var closeFunc=function(){configureIsPending=!1;},interfaceFunc=function(confFunc){confFunc(userConfig,function(newSettings){store.set('RefPopupsJS',newSettings);cleanupPopups();applyHoverEvents();$(window).trigger('dev-ReferencePopups-config',module.settings=$.extend({},newSettings));},closeFunc);};if(configureIsPending){return;}configureIsPending=!0;if(module.configure){$.when(module.configure).done(interfaceFunc).fail(closeFunc);return;}$.ajax({url:mw.config.get('wgLoadScript'),data:{mode:'articles',only:'scripts',articles:'w:dev:ReferencePopups/code.configure.js'},dataType:'script',cache:!0}).then(function(){$.when(module.configure).done(interfaceFunc).fail(closeFunc);}).fail(closeFunc);}function constructPopup($ref){var frag=$ref.find('a[href^="#cite_note"]').first();if(!frag.length){return null;}var $cite=$(frag.attr('href').replace(/\./g,'\\.'));if(!$cite.length){return null;}var $content=$('<div style="overflow:auto">'),$conf=$(
'<a href="#" class="refpopups-configure" />').prop('title',module.messages.coreConfigureHover).click(onClickConfigure);$content.append($cite.find('.reference-text').clone());return new module.Popup({content:$conf.add($content),activateBy:userConfig.react,hoverDelay:userConfig.hoverDelay,animation:userConfig.animate&&'fold',stickyHover:userConfig.stick,contentBoxClass:'WikiaArticle'},$ref[0]);}});;(function($,mw,RevealAnonIP,ArticleComments,WikiActivity){"use strict";RevealAnonIP=$.extend(RevealAnonIP,{});RevealAnonIP.permissions=$.extend(['*'],RevealAnonIP.permissions);if(typeof(RevealAnonIP.reveal)==='function'){return;}var hasPermission=(function(){var permissions=RevealAnonIP.permissions;var usergroups;usergroups=mw.config.get('wgUserGroups');usergroups=$.extend(['*'],usergroups);for(var i=0,plen=permissions.length;i<plen;++i){for(var j=0,ulen=usergroups.length;j<ulen;++j){if(usergroups[j]===permissions[i]){return true;}}}return false;}());function revealIPs(){if(!hasPermission){
return;}var isIPv4Address=mw.util.isIPv4Address,isIPv6Address=mw.util.isIPv6Address;$('.edited-by > a').not('#Wall *').add($('#Forum .last-post > a').filter(function(){return!this.children.length;})).add('.activityfeed cite a, .activity-module .edit-info-user').each(function(){var $this=$(this),href=$this.attr('href'),lastSlash=href.lastIndexOf('/'),ip;if(lastSlash!==-1){ip=href.substr(lastSlash+1);if(isIPv4Address(ip)||isIPv6Address(ip)){$this.text(ip);}}});}RevealAnonIP.reveal=$.noop;RevealAnonIP.getPermission=function(){return hasPermission;};RevealAnonIP.init=function(){hasPermission=!0;mw.loader.using('mediawiki.util',function(){RevealAnonIP.reveal=revealIPs;$(function(){if(ArticleComments){var realFunc=ArticleComments.addHover;ArticleComments.addHover=function(){var result=realFunc.apply(this,arguments);RevealAnonIP.reveal();return result;};}else{if(WikiActivity){var ajaxFunc=WikiActivity.ajax;WikiActivity.ajax=function(a,b,callback){return ajaxFunc.call(this,a,b,function(){var
result=callback.apply(this,arguments);RevealAnonIP.reveal();return result;});};}if(!$.isArray(window.ajaxCallAgain)){window.ajaxCallAgain=[];}window.ajaxCallAgain.push(RevealAnonIP.reveal);}RevealAnonIP.reveal();});});this.init=$.noop;};if(hasPermission){RevealAnonIP.init();}window.RevealAnonIP=RevealAnonIP;}(jQuery,mediaWiki,window.RevealAnonIP,window.ArticleComments,window.WikiActivity));;$('.topeditors').each(function(){var myDate=new Date(),end=myDate.toJSON(),start='',$te=$(this),userlist={},html='',namespace=($te.attr('data-te-namespace')||''),type=($te.attr('data-te-type')||'edit|new'),show=($te.attr('data-te-show')||''),user=$te.attr('data-te-user')?'&rcuser='+$te.attr('data-te-user'):'',limit=(Number($te.attr('data-te-limit'))||25),dateoffset=(Number($te.attr('data-te-offset'))||7),exclude=($te.attr('data-te-exclude')?JSON.parse($te.attr('data-te-exclude')):'');limit=user?1:limit;myDate.setDate(myDate.getDate()-dateoffset);start=myDate.toJSON();function requestLoop(strt,
callback){$.getJSON(mw.util.wikiScript('api'),{action:'query',list:'recentchanges',rcstart:strt,rcend:end,rcnamespace:namespace,rcshow:show,rctype:type,rcuser:user||undefined,rcdir:'newer',rcprop:'user',rclimit:'max',format:'json'},function(data){var username;for(var change in data.query.recentchanges){username=data.query.recentchanges[change].user;if(exclude.hasOwnProperty(username)){continue;}if(userlist[username]!==undefined){userlist[username]+=1;}else{userlist[username]=1;}}start=data['query-continue'];if(start!==undefined){requestLoop(start.recentchanges.rcstart,callback);}else{callback();}});}requestLoop(start,function(){var userslist=[];for(var x in userlist){userslist.push({'user':x,'count':userlist[x]});}userslist.sort(function(a,b){if(a.count>b.count){return-1;}else if(a.count<b.count){return 1;}else{if(a.user<b.user){return-1;}else if(a.user>b.user){return 1;}else{return 0;}}});for(var i=0;i<userslist.length&&i<limit;i++){if(user){html+=userslist[i].count;}else{html+=
'<li><a href="'+mw.util.getUrl('User:'+userslist[i].user)+'">'+userslist[i].user+'</a>: '+userslist[i].count+'</li>';}}user?$te.html(html):$te.html('<ol>'+html+'</ol>');});});;(function(window,$,mw){'use strict';var config=mw.config.get(['wgAction','wgNamespaceNumber','wgTitle','wgUserGroups','wgUserName']),groups=config.wgUserGroups.join(' ');if(config.wgNamespaceNumber===1202){$('#ca-talk').remove();return;}else if(config.wgTitle.indexOf('/')!==-1||config.wgNamespaceNumber!==1200||!(config.wgUserName===config.wgTitle||/sysop|threadmoderator|vstf|helper|staff/.test(groups))||config.wgAction!=='edit'||window.WallGreetingButtonLoaded){return;}window.WallGreetingButtonLoaded=!0;function init(i18n){i18n.useUserLang();var params={url:new mw.Title(config.wgTitle,1202).getUrl(),wallUrl:new mw.Title(config.wgTitle,1200).getUrl()};['editGreeting','history','wallHistory','delete','protect','raw'].forEach(function(el){params[el]=i18n.msg(el).plain();});$('#WikiaMainContentContainer').prepend(
window.Mustache.render('<div class="page-header" id="PageHeader" style="padding: 0;">'+'<div class="UserProfileActionButton" id="EditMessageWallGreeting">'+'<div class="wds-button-group" id="ca-edit" style="text-align: left;">'+'<a accesskey="e" href="{{url}}?action=edit" class="wds-is-squished wds-button">'+'<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" class="wds-icon wds-icon-small" id="wds-icons-pencil-small">'+'<path d="M9.1 4.5l-7.8 7.8c-.2.2-.3.4-.3.7v3c0 .6.4 1 1 1h3c.3 0 .5-.1.7-.3l7.8-7.8-4.4-4.4zm7.6-.2l-3-3c-.4-.4-1-.4-1.4 0l-1.8 1.8 4.4 4.4 1.8-1.8c.4-.4.4-1 0-1.4z" fill-rule="evenodd"></path>'+'</svg>'+'<span>{{editGreeting}}</span>'+'</a>'+'<div class="wds-dropdown">'+'<div class="wds-button wds-is-squished wds-dropdown__toggle">'+'<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" class="wds-icon wds-icon-tiny wds-dropdown__toggle-chevron" id="wds-icons-dropdown-tiny">'+
'<path d="M6 9l4-5H2" fill-rule="evenodd"></path>'+'</svg>'+'</div>'+'<div class="wds-dropdown__content wds-is-not-scrollable wds-is-right-aligned" style="z-index: 2;">'+'<ul class="wds-list wds-is-linked">'+'<li><a id="ca-history" href="{{url}}?action=history">{{history}}</a></li>'+'<li><a accesskey="h" href="{{wallUrl}}?action=history">{{wallHistory}}</a></li>'+(/sysop|content-moderator|vstf|helper|staff/.test(groups)?'<li><a id="ca-delete" href="{{url}}?action=delete">{{delete}}</a></li>'+(window.WallGreetingButtonProtect?'<li><a id="ca-protect" href="{{url}}?action=protect">{{protect}}</a></li>':''):'')+(window.WallGreetingButtonRaw?'<li><a id="ca-raw" href="{{url}}?action=raw">{{raw}}</a></li>':'')+'</ul>'+'</div>'+'</div>'+'</div>'+'</div>'+'</div>',params));}importArticle({type:'script',article:'u:dev:MediaWiki:I18n-js/code.js'});mw.hook('dev.i18n').add(function(i18no){$.when(i18no.loadMessages('WallGreetingButton'),mw.loader.using(['mediawiki.Title','wikia.mustache'])).then(
init);});})(window,jQuery,mediaWiki);;(function(){'use strict';var mconfig=mw.config.get(['wgUserLanguage','wgUserName']);if(window.DiscordIntegratorLoaded){return;}window.DiscordIntegratorLoaded=!0;var DiscordIntegrator={config:(window.DiscordIntegratorConfig||{}).siderail||{},hook:function(i18n){$.when(i18n.loadMessages('DiscordIntegrator'),mw.loader.using('mediawiki.api')).then($.proxy(this.preload,this));},preload:function(i18n){this.i18n=i18n;mw.hook('wikipage.content').add($.proxy(this.insertToContent,this));this.api=new mw.Api();this.api.get({action:'query',meta:'allmessages',ammessages:['id','title','moduleHeight','theme','width','height','text','logged-in','footer','username'].map(function(el){return'Custom-DiscordIntegrator-config-'+el;}).join('|'),amlang:mconfig.wgUserLanguage,smaxage:300,maxage:300}).done($.proxy(function(d){if(!d.error){d.query.allmessages.forEach(function(el){if(el['*']){this.config[el.name.substring(32)]=el['*'];}},this);this._loading=0;['text','title'
,'footer'].forEach(this.parse,this);if(this._loading===0){this.init();}}},this));},parse:function(msg){if(this.config[msg]){++this._loading;this.api.get({action:'parse',text:this.config[msg]}).done($.proxy(function(d){if(!d.error){this.config[msg]=d.parse.text['*'];if(--this._loading===0){this.init();}}},this));}},init:function(){if(this.config.id&&$('#WikiaRail').length>0){var clas=$('#WikiaRail').attr('class');if(clas&&clas.split(/\s+/).indexOf('loaded')===-1){$('#WikiaRail').on('afterLoad.rail',$.proxy(this.insertToSiderail,this));}else{this.insertToSiderail();}}},insertToSiderail:function(){var filter=$('#top-right-boxad-wrapper, #top-boxad-wrapper, #NATIVE_TABOOLA_RAIL, .content-review-module').last(),el=$('<div>',{class:'DiscordIntegratorModule rail-module'});if(this.config.title){el.append($('<h2>',{'class':'activity-heading',html:this.config.title}));}if(this.config.text){el.append($('<p>',{id:'DiscordIntegratorModuleText',html:this.config.text}));}el.append(this.
generateContent(this.config));if(this.config.footer){el.append($('<p>',{id:'DiscordIntegratorModuleFooter',html:this.config.footer}));}if(filter.length>0){el.insertAfter(filter);}else{$('#WikiaRail').prepend(el);}if(this.config.moduleHeight){mw.util.addCSS('.DiscordIntegratorModule { height: '+Number(this.config.moduleHeight)+'px; }');}mw.hook('DiscordIntegrator.added').fire(el);},insertToContent:function($content){$content.find('.DiscordIntegrator:not(.loaded)').each($.proxy(function(cabbage,el){el=$(el);el.html(this.generateContent(el.data())).addClass('loaded');},this));},generateContent:function(config){return config.id?((config.loggedIn===true||(Boolean(config['logged-in'])===true&&config['logged-in']!=='false'&&config['logged-in']!=='{{{loggedIn}}}'))&&!mconfig.wgUserName)?this.i18n.msg('login').parse():mw.html.element('iframe',{src:'https://discordapp.com/widget?id='+config.id+'&theme='+(config.theme==='light'?'light':'dark')+'&username='+encodeURIComponent(config.username===
'@disabled'?'':config.username==='@function'&&typeof window.DiscordIntegratorGetUsername==='function'?window.DiscordIntegratorGetUsername():config.username||mconfig.wgUserName),width:config.width||'100%',height:config.height||'400px',allowtransparency:'true',frameborder:'0'}):this.i18n.msg('error').escape();}};mw.hook('dev.i18n').add($.proxy(DiscordIntegrator.hook,DiscordIntegrator));importArticle({type:'script',article:'u:dev:MediaWiki:I18n-js/code.js'});})();;;(function($,mw){var namespace=mw.config.get('wgNamespaceNumber');if(namespace!==2&&namespace!==1200&&namespace!==500&&(namespace!==4||mw.config.get('wgTitle')!=='Medals'||mw.config.get('wgAction')!=='view')){return;}medalFunctions={medalDefaultSettings:function(){default_cfg=JSON.stringify({dataUser:{},dataMedal:{},module_title:'User\'s reward',module_more:'Show more',module_count_info:'Amounts of this achievement',module_info:'',module_info_title:'',border:{top_left:
'https://images.wikia.nocookie.net/siegenax/ru/images/1/13/Medal_Border_corner.png',top_right:'https://images.wikia.nocookie.net/siegenax/ru/images/d/de/Medal_Border_corner_right.png'}});$('#mw-content-text').prepend('<div style="width:100%; text-aling:center; padding:20px;">Settings not exist or broken.&nbsp;<button id="MedalResetSettings">Reset them?</button></div>');$('#MedalResetSettings').click(function(){medalFunctions.saveSettingFunction(default_cfg);});},switchSettings:function(class_name){$('.MedalSetMenu').hide();$('.'+class_name).show();},medalMatcher:function(url){if(url.match(/https?:\/\/(images?|vignette)\d?\.wikia\.nocookie\.net\//)){return true;}return false;},addMedalForm:function(){$('.MedalList').append('<div class="MedalForm CustomForm" style="padding-bottom:5px; border-bottom:1px solid grey;">'+'<div class="MedalImagePreview" style="display:inline-block; width:80px; text-align:center;">'+'<img height="70" style="margin:0 5px -3px 0; cursor:help;"/>'+'</div>'+
'<div style="display:inline-block; width:475px;">'+'<div style="margin-top:5px;">'+'<button onclick="medalFunctions.appendMedalSettings($(this).parents(\'.MedalForm\'))" style="padding:0 4px; margin:0 6px 0 0; float:right;" title="Submit changes">✓</button>'+'<button onclick="medalFunctions.deleteMedalSettings($(this).parents(\'.MedalForm\'))" style="padding:0 0 0 3px; margin:0 5px 0 0; float:right;">'+medalDeleteImg+'</button>'+'Medal name : '+'<input class="MedalListName" style="float:right; width:334px; margin-right:5px;" data-prev="undefined"/>'+'</div>'+'<div style="margin-top:5px;">'+'Title : '+'<input class="MedalListTitle" style="float:right; width:385px; margin-right:5px;" />'+'</div>'+'<div style="margin-top:5px;">'+'Image link : '+'<input class="MedalListLinkImage" style="float:right; width:385px;  margin-right:5px;" />'+'</div>'+'</div>'+'</div>');},addUserForm:function(){$('.MedalUser').append(
'<div class="UserForm CustomForm" style="text-align:center; margin-top:5px; border-bottom:1px solid black; padding-bottom:5px;">'+'<input class="MedalUserName" style="float:left; width:40%; margin-left:5px;" />'+'<button onclick="$(this).parents(\'.CustomForm\').remove()" style="padding:0 0 0 3px; margin:0 5px; float:left;">'+medalDeleteImg+'</button>'+'<button onclick="$(this).parents(\'.UserForm\').find(\'.medalCollectForm\').toggle()" style="padding:0 0 0 3px; margin:0 5px; width:100px;">Medals</button>'+'<br />'+medalCollectForm+'</div>');},appendMedalSettings:function($that){var imgLink=$that.find('.MedalListLinkImage').val();var titleNew=$that.find('.MedalListTitle').val();var nameNew=$that.find('.MedalListName').val();var prevName=$that.find('.MedalListName').attr('data-prev');$that.find('.MedalImagePreview img').attr('src',imgLink).attr('title',titleNew).attr('data-prev',nameNew);if($(medalCollectForm).find('[data-section="'+nameNew+'"]').length){return;}var to_add=
'<div class="medalCollectBox" data-section="'+mw.html.escape(nameNew)+'" style="display:inline-block; margin:5px 0 0 10px;">'+'<input type="checkbox">'+mw.html.escape(nameNew)+'&nbsp;<input class="MedalCollectAmount" style="width:30px; text-align:center;"/>'+'</div>';var medalCollectSaveForm=$(medalCollectForm).append(to_add);$('.medalCollectForm').each(function(){$(this).append(to_add);});if(prevName!=='undefined'){$('[data-section="'+prevName+'"]').remove();medalCollectSaveForm.find('[data-section="'+prevName+'"]').remove();}medalCollectForm=medalCollectSaveForm.prop('outerHTML');},deleteMedalSettings:function($that){var medal_name=$that.find('.MedalListName').val();var prev_name=$that.find('.MedalListName').attr('data-prev');var medalCollectSaveForm=$(medalCollectForm);medalCollectSaveForm.find('[data-section="'+medal_name+'"], [data-section="'+prev_name+'"]').remove();medalCollectForm=medalCollectSaveForm.prop('outerHTML');$that.remove();$('[data-section="'+medal_name+
'"], [data-section="'+prev_name+'"]').remove();},medalCollectFunction:function(){result={};result.dataUser={};result.dataMedal={};result.module_title=$('#MedalTitle').val();result.module_more=$('#MedalMore').val();result.module_count_info=$('#MedalCount').val();result.module_info=$('#MedalInfo').val();result.module_info_title=$('#MedalInfoTitle').val();result.border={top_left:$('#MedalBorderLeft').val(),top_right:$('#MedalBorderRight').val()};$('.UserForm').each(function(){var user=$(this).find('.MedalUserName').val();if(user==='')return;var medals=[];$(this).find('.medalCollectBox').each(function(){if($(this).find('input[type="checkbox"]').attr('checked')!=='checked'){return;}var medal_name=$(this).attr('data-section');var medal_count=$(this).find('.MedalCollectAmount').val();if(medal_count.match(/\d+/)&&medal_count!==1){medal_name+=':'+medal_count;}medals.push(medal_name);});result.dataUser[user]=medals;});$('.MedalForm').each(function(){var medal_name=$(this).find('.MedalListName').
val();if(medal_name==='')return;var medal_image=$(this).find('.MedalListLinkImage').val();if(!medalFunctions.medalMatcher(medal_image))return;result.dataMedal[medal_name]={title:$(this).find('.MedalListTitle').val(),image_url:medal_image};});return result;},saveSettingFunction:function(medalSet){$.ajax({url:mw.util.wikiScript('api'),type:'POST',data:{action:'edit',title:'Project:Medals',summary:'Settings changes',text:medalSet,bot:1,token:mw.user.tokens.get('editToken'),format:'json'},success:function(d){if(d.edit.result=='Success'){location.href+=(location.href.indexOf('?')>-1)?'&action=purge':'?action=purge';}}});},tooltip:function(that){title=$(that).attr('data-title');badgename=$(that).attr('data-name');offSet=$(that).offset();setOffX=parseFloat(offSet.left)-86+$(that).width()/2;setOffY=parseFloat(offSet.top)+$(that).height()+5;$('body').append('<div class="badgetooltip" style="position:absolute; z-index:5000;">'+
'<div class="badgetooltiparrow" style="width:0; height:0; border-left: 10px solid transparent; border-right: 10px solid transparent; border-bottom: 10px solid black; margin: 0 auto;" />'+'<div class="badgetootipwindow" style="width: 160px; background-color:white; border:2px solid black; border-radius:5px; text-align:center; padding:5px;">'+$('<span style="font-weight:bold;" />').text(badgename).prop('outerHTML')+'<hr />'+$('<span />').text(title).prop('outerHTML')+'</div>'+'</div>');$('.badgetooltip').css({top:setOffY,left:setOffX});$(that).on('mouseout',function(){$('.badgetooltip').remove();});},medalMainFunction:function(){if(typeof MedalSettings==='undefined'){return;}user=mw.config.get('wgTitle');medalModal=!1;if(typeof MedalSettings.dataUser[user]==='undefined'||!MedalSettings.dataUser[user].length){return;}medalBorderRight=(medalFunctions.medalMatcher(MedalSettings.border.top_right))?$('<img width="40" />').attr('src',MedalSettings.border.top_right).prop('outerHTML'):'';
medalBorderLeft=(medalFunctions.medalMatcher(MedalSettings.border.top_left))?$('<img width="40" />').attr('src',MedalSettings.border.top_left).prop('outerHTML'):'';$('#WikiaRail').prepend('<section class="RewardModule rail-module">'+'<div class="RewardContainer" style="position:relative; width:100%; padding: 0;">'+'<div style="position:absolute; top:0; left:0;">'+medalBorderLeft+'</div>'+'<div style="position:absolute; top:0; right:0;">'+medalBorderRight+'</div>'+'<div style="position:absolute; bottom:0; left:0; transform:rotate(180deg); -ms-transform:rotate(180deg); -webkit-transform:rotate(180deg); -moz-transform:rotate(180deg); -o-transform:rotate(180deg);">'+medalBorderRight+'</div>'+'<div style="position:absolute; bottom:0; right:0; transform:rotate(180deg); -ms-transform:rotate(180deg); -webkit-transform:rotate(180deg); -moz-transform:rotate(180deg); -o-transform:rotate(180deg);">'+medalBorderLeft+'</div>'+$('<h2 class="activity-heading" />').text(MedalSettings.module_title).prop
('outerHTML')+'<div class="RewardSection" style="margin:0 5px;">'+'<div class="in" style="text-align:center;" />'+'</div>'+'<div class="MedalAdditionalSection" style="width:100%; text-align:center;" />'+'</div>'+'</section>');if(MedalSettings.dataUser[user].length>12){medalModal=!0;medalModalForm.append('<div class="ModalMedalCollection"><div class="in" style="text-align:center;"/></div>');$('.MedalAdditionalSection').append($('<button type="button" class="MedalMore" style="cursor:pointer;" />').text((MedalSettings.module_more===''||typeof(MedalSettings.module_more)==='undefined')?'Show more':MedalSettings.module_more).prop('outerHTML'));}if(MedalSettings.module_info!==''&&typeof(MedalSettings.module_info)!=='undefined'){$('.MedalAdditionalSection').append($('<a class="button" style="margin-left:1px; cursor:info;"/>').text(MedalSettings.module_info_title).attr('href',mw.config.get('wgServer')+mw.config.get('wgScriptPath')+'/wiki/'+MedalSettings.module_info).prop('outerHTML'));}if(!$(
'.MedalAdditionalSection').is(':empty')){$('.MedalAdditionalSection').css('margin','5px 0 -20px 0');}$.each(MedalSettings.dataUser[user],function(i,v){imgBody='';if(v.indexOf(':')>-1){count=v.replace(/.+:(.+)/g,'$1');v=v.replace(/(.+):.+/g,'$1');imgBody+=$('<div class="RewardCount" style="position:absolute; bottom:0; right:0; padding:0 4px; background-color:white; border:1px solid black; border-radius:10px; cursor:help; color:black;" />').text('x'+count).attr('title',MedalSettings.module_count_info).prop('outerHTML');}if(typeof(MedalSettings.dataMedal[v])==='undefined'||typeof(MedalSettings.dataMedal[v].image_url)==='undefined'||!medalFunctions.medalMatcher(MedalSettings.dataMedal[v].image_url)){return;}imgBody+=$('<img style="cursor:help; vertical-align:middle;" width="50" onmouseover="medalFunctions.tooltip(this);" />').attr('src',MedalSettings.dataMedal[v].image_url).attr('data-title',MedalSettings.dataMedal[v].title).attr('data-name',v).prop('outerHTML');if(medalModal){
medalModalForm.find('.ModalMedalCollection .in').append('<div class="RewardImage" style="display:inline-block; position:relative; margin:2px 5px;">'+imgBody+'</div>');if(i>11)return;}$('.RewardSection .in').append('<div class="RewardImage" style="display:inline-block; position:relative; margin:2px 5px;">'+imgBody+'</div>');});$('.MedalMore').click(function(){$.showCustomModal(mw.html.escape(MedalSettings.module_title+' '+user),medalModalForm,{width:400});});},medalSettingsFunction:function(){var group_list=mw.config.get('wgUserGroups');if(group_list.indexOf('sysop')==-1&&group_list.indexOf('content-moderator')==-1&&group_list.indexOf('helper')==-1&&group_list.indexOf('staff')==-1&&group_list.indexOf('vstf')==-1){return;}medalCollect=[];medalDeleteImg='<img src="data:image/gif;base64,R0lGODlhAQABAIABAAAAAP///yH5BAEAAAEALAAAAAABAAEAQAICTAEAOw%3D%3D" class="sprite trash" />';medalCollectForm=$(
'<div class="medalCollectForm" style="display:none; text-align:left; margin-top:5px; border-top:1px solid black;" />');if(typeof MedalSettings==="undefined"){medalFunctions.medalDefaultSettings();return;}$('#mw-content-text').prepend('<div style="width:100%; text-align:center; padding:20px;"><button id="MedalSettings">Access settings</button></div>');medalModalForm.append('<div style="padding-bottom:5px; border-bottom:solid 1px #36759c; margin-top:-5px;">'+'<div style="text-align:center;">'+'<button type="button" class="wikia-button medalSwitch" onclick="medalFunctions.switchSettings(\'MedalMainDialog\')">Main</button>&nbsp;'+'<button type="button" class="wikia-button medalSwitch" onclick="medalFunctions.switchSettings(\'MedalUserDialog\')">Users</button>&nbsp;'+'<button type="button" class="wikia-button medalSwitch" onclick="medalFunctions.switchSettings(\'MedalListDialog\')">Medals</button>'+'</div>'+'</div>'+'<div style="height:270px;">'+'<div class="MedalMainDialog MedalSetMenu">'+
'<h2 style="padding:5px 0 5px 5px; background-color:rgba(0,0,0,0.1); border-bottom:solid 1px #36759c; margin-bottom:5px;">Main Settings</h2>'+'<div>Module title: '+$('<input id="MedalTitle" style="float:right; width:80%;" />').attr('value',MedalSettings.module_title).prop('outerHTML')+'</div>'+'<div style="margin-top:5px;">Expand button: '+$('<input id="MedalMore" style="float:right; width:80%;" />').attr('value',MedalSettings.module_more).prop('outerHTML')+'</div>'+'<div style="margin-top:5px;">Medal count: '+$('<input id="MedalCount" style="float:right; width:80%;" />').attr('value',MedalSettings.module_count_info).prop('outerHTML')+'</div>'+'<div style="margin-top:5px;">Medal info page: '+$('<input id="MedalInfo" style="float:right; width:80%;" />').attr('value',MedalSettings.module_info).prop('outerHTML')+'</div>'+'<div style="margin-top:5px;">Medal info title: '+$('<input id="MedalInfoTitle" style="float:right; width:80%;" />').attr('value',MedalSettings.module_info_title).prop(
'outerHTML')+'</div>'+'<div style="margin-top:5px;">Border left: '+$('<input id="MedalBorderLeft" style="float:right; width:80%;" />').attr('value',MedalSettings.border.top_left).prop('outerHTML')+'</div>'+'<div style="margin-top:5px;">Border right: '+$('<input id="MedalBorderRight" style="float:right; width:80%;" />').attr('value',MedalSettings.border.top_right).prop('outerHTML')+'</div>'+'</div>'+'<div class="MedalUserDialog MedalSetMenu" style="display:none;">'+'<h2 style="padding:5px 0 5px 5px; background-color:rgba(0,0,0,0.1); border-bottom:solid 1px #36759c;">'+'Users'+'<button onclick="medalFunctions.addUserForm()" style="padding:0 4px; margin:0 10px 0 0; float:right;">Add user form</button>'+'</h2>'+'<div class="MedalUser" style="height:240px; overflow-y:scroll; border-bottom:solid 1px #36759c;"/>'+'</div>'+'<div class="MedalListDialog MedalSetMenu" style="display:none;">'+'<h2 style="padding:5px 0 5px 5px; background-color:rgba(0,0,0,0.1); border-bottom:solid 1px #36759c;">'+
'Medals'+'<button onclick="medalFunctions.addMedalForm()" style="padding:0 4px; margin:0 10px 0 0; float:right;">Add medal form</button>'+'</h2>'+'<div class="MedalList" style="height:240px; overflow-y:scroll; border-bottom:solid 1px #36759c;" />'+'</div>'+'</div>');$.each(MedalSettings.dataMedal,function(k,v){medalCollect.push(k);medalModalForm.find('.MedalList').append('<div class="MedalForm CustomForm" style="padding-bottom:5px; border-bottom:1px solid grey;">'+'<div class="MedalImagePreview" style="display:inline-block; width:80px; text-align:center;">'+$('<img height="70" style="margin:0 5px -3px 0; cursor:help;"/>').attr('src',v.image_url).attr('title',v.title).prop('outerHTML')+'</div>'+'<div style="display:inline-block; width:475px;">'+'<div style="margin-top:5px;">'+'<button onclick="medalFunctions.appendMedalSettings($(this).parents(\'.MedalForm\'))" style="padding:0 4px; margin:0 6px 0 0; float:right;">✓</button>'+
'<button onclick="medalFunctions.deleteMedalSettings($(this).parents(\'.MedalForm\'))" style="padding:0 0 0 3px; margin:0 5px 0 0; float:right;">'+medalDeleteImg+'</button>'+'Medal name : '+$('<input class="MedalListName" style="float:right; width:334px; margin-right:5px;" />').attr('value',k).attr('data-prev',k).prop('outerHTML')+'</div>'+'<div style="margin-top:5px;">'+'Title : '+$('<input class="MedalListTitle" style="float:right; width:385px; margin-right:5px;" />').attr('value',v.title).prop('outerHTML')+'</div>'+'<div style="margin-top:5px;">'+'Image link : '+$('<input class="MedalListLinkImage" style="float:right; width:385px;  margin-right:5px;" />').attr('value',v.image_url).prop('outerHTML')+'</div>'+'</div>'+'</div>');});$.each(medalCollect,function(i,v){medalCollectForm.append($('<div class="medalCollectBox" style="display:inline-block; margin:5px 0 0 10px;">'+'<input type="checkbox">'+$('<span />').text(v+' ').prop('outerHTML')+
'<input class="MedalCollectAmount" style="width:30px; text-align:center;"/>'+'</div>').attr('data-section',v).prop('outerHTML'));});medalCollectForm=medalCollectForm.prop('outerHTML');$.each(MedalSettings.dataUser,function(k,v){var medalCollectFormNew=$(medalCollectForm);$.each(v,function(i,val){if(val.indexOf(':')>-1){var count=val.replace(/.+:(.+)/g,'$1');val=val.replace(/(.+):.+/g,'$1');medalCollectFormNew.find('.medalCollectBox[data-section="'+val+'"] .MedalCollectAmount').attr('value',count);}medalCollectFormNew.find('.medalCollectBox[data-section="'+val+'"] input[type="checkbox"]').attr('checked','checked');});medalModalForm.find('.MedalUser').append('<div class="UserForm CustomForm" style="text-align:center; margin-top:5px; border-bottom:1px solid black; padding-bottom:5px;">'+$('<input class="MedalUserName" style="float:left; width:40%; margin-left:5px;" />').attr('value',k).prop('outerHTML')+
'<button onclick="$(this).parents(\'.CustomForm\').remove()" style="padding:0 0 0 3px; margin:0 5px; float:left;">'+medalDeleteImg+'</button>'+'<button onclick="$(this).parents(\'.UserForm\').find(\'.medalCollectForm\').toggle()" style="padding:0 0 0 3px; margin:0 5px; width:100px;"> Medals</button>'+'<br />'+medalCollectFormNew.prop('outerHTML')+'</div>');});medalModalFormCompleted=medalModalForm.prop('outerHTML');$('#MedalSettings').click(function(){$.showCustomModal('Settings',medalModalFormCompleted,{id:'ModalSettingsWindow',width:600,height:450,buttons:[{message:'Purge page',handler:function(){location.href+=(location.href.indexOf('?')>-1)?'&action=purge':'?action=purge';}},{message:'Reset changes',handler:function(){$('#ModalSettingsWindow fieldset').replaceWith(medalModalFormCompleted);}},{message:'Save',handler:function(){result_data=JSON.stringify(medalFunctions.medalCollectFunction());medalFunctions.saveSettingFunction(result_data);}}]});});},init:function(){$.ajax({url:mw.
util.wikiScript(),type:'GET',data:{title:'Project:Medals',action:'raw',cb:Math.ceil(new Date().getTime()/1000),dataType:'text'},success:function(data){try{MedalSettings=JSON.parse(data);}catch(err){if(namespace===4){medalFunctions.medalDefaultSettings();}return;}medalModalForm=$('<fieldset style="border:solid 1px #36759c; margin:0; padding:1em;" />');if(namespace!=4){medalFunctions.medalMainFunction();}else{medalFunctions.medalSettingsFunction();}},error:function(){if(namespace===4){medalFunctions.medalDefaultSettings();}}});}};$(medalFunctions.init);})(this.jQuery,this.mediaWiki);;require(['jquery','mw'],function($,mw){var storageKey='ls-wikianotifications';function log(error){console.log('WikiaNotifications error: '+error);}function getNotificationData(){return(new mw.Api()).get({action:'parse',disablepp:'',page:'MediaWiki:Custom-WikiaNotifications',format:'json'}).then(function(res){var dfd=$.Deferred();if(res.error){return dfd.rejectWith(this,[res.error.info]);}var text=res.parse.
text['*'].trim();text=(text||'').replace(/<script>[\s\S]*?<\/script>/igm,'').replace(/<!\-\-[\s\S]*?\-\->/igm,'');if(!text.length||!text.trim().length){return dfd.rejectWith(this,['empty content']);}return dfd.resolveWith(this,[{version:res.parse.revid,contents:text}]);});}function showNotificationIfNotViewed(notification){var notifsData=JSON.parse(window.localStorage.getItem(storageKey))||{},hasSeen=(notifsData[mw.config.get('wgCityId')]===notification.version),$notificationArea=$('#WikiaNotifications'),hasNotifications=$notificationArea.length?1:0;if(hasSeen){return;}var $notif=$('<li/>').attr('class','custom').append($('<div>').attr('data-type','2').html(notification.contents).append($('<a>').addClass('sprite close-notification')));if(hasNotifications){$notificationArea.append($notif);}else{$('body').addClass('notifications').append($('<ul id="WikiaNotifications" class="WikiaNotifications"></ul>').append($notif));}$('.sprite.close-notification').on('click',function(){$notif.hide();
notifsData[mw.config.get('wgCityId')]=notification.version;window.localStorage.setItem(storageKey,JSON.stringify(notifsData));});}mw.loader.using('mediawiki.api',function(){if(mw.config.get('wgUserName')){$(function(){getNotificationData().then(showNotificationIfNotViewed).fail(log);});}});});;function strPad(n){return String("00"+n).slice(-2);}function updateContent(content,isMod,canBlock,arr){for(var i=arr._embedded["doc:posts"].length-1;i>-1;i--){var text=arr._embedded["doc:posts"][i].rawContent,user=arr._embedded["doc:posts"][i].createdBy.name,userId=arr._embedded["doc:posts"][i].createdBy.id,epoch=arr._embedded["doc:posts"][i].creationDate.epochSecond,postID=arr._embedded["doc:posts"][i].id,threadID=arr._embedded["doc:posts"][i].threadId,isReported=Boolean(arr._embedded["doc:posts"][i].isReported),forumName=arr._embedded["doc:posts"][i].forumName,dt=new Date(epoch*1000),formattedDate=strPad(dt.getHours())+":"+strPad(dt.getMinutes())+":"+strPad(dt.getSeconds());var spanDate=
document.createElement("span"),spanDateText=document.createTextNode(formattedDate+" — ");spanDate.className="df-date";spanDate.appendChild(spanDateText);var aMessage=document.createElement("a"),aMessageText=document.createTextNode(text);aMessage.className="df-content";aMessage.href=mw.config.get('wgScriptPath')+"/f/p/"+threadID;aMessage.target="_blank";aMessage.appendChild(aMessageText);var aUser=document.createElement("a"),aUserText=document.createTextNode(" — "+user);aUser.className="df-user";aUser.href=mw.config.get('wgScriptPath')+"/f/u/"+userId;aUser.target="_blank";aUser.appendChild(aUserText);var spanCategory=document.createElement("span"),spanCategoryText=document.createTextNode(" in "+forumName);spanCategory.className="df-category";spanCategory.appendChild(spanCategoryText);if(canBlock){var aBlock=document.createElement("a"),aBlockText=document.createTextNode(" (block)");aBlock.className="df-block";aBlock.href=mw.util.getUrl("Special:Block/")+user;aBlock.target="_blank";
aBlock.appendChild(aBlockText);}var par=document.createElement("p");par.className="df-entry";if(isReported){par.className+=" df-reported";}par.appendChild(spanDate);par.appendChild(aMessage);par.appendChild(aUser);par.appendChild(spanCategory);if(canBlock){par.appendChild(aBlock);}content.insertBefore(par,content.firstChild);}}function updateFeed(content,isMod,canBlock,epoch){var rcLimit=50,dt=new Date(epoch*1000+1),request=new XMLHttpRequest();request.onreadystatechange=function(){if(request.readyState==4){switch(request.status){case 200:var arr=JSON.parse(request.responseText);updateContent(content,isMod,canBlock,arr);if(arr._embedded["doc:posts"].length>0){epoch=arr._embedded["doc:posts"][0].creationDate.epochSecond;}break;default:setTimeout(updateFeed,120000,content,isMod,canBlock,epoch);}}};request.open("GET","https://services.fandom.com/discussion/"+wgCityId+"/posts?limit="+rcLimit+"&since="+dt.toISOString()+"&page=0&responseGroup=small&reported=false&viewableOnly="+(!isMod).
toString(),true);request.setRequestHeader('Accept','application/hal+json');request.withCredentials=!0;request.send();}function initFeed(content,isMod,canBlock){var rcLimit=50,request=new XMLHttpRequest();request.timeout=30000;request.ontimeout=function(){content.innerHTML="Unable to load discussions: The service is down or is not enabled for this domain.";};request.onreadystatechange=function(){if(request.readyState==4){switch(request.status){case 200:var arr=JSON.parse(request.responseText);content.innerHTML='';updateContent(content,isMod,canBlock,arr);var epoch=arr._embedded["doc:posts"][0].creationDate.epochSecond;setTimeout(updateFeed,120000,content,isMod,canBlock,epoch);break;case 404:content.innerHTML='There are no posts.';break;default:content.innerHTML="Unable to load discussions: The service is down or is not enabled for this domain.";}}};request.open("GET","https://services.fandom.com/discussion/"+wgCityId+"/posts?limit="+rcLimit+
"&page=0&responseGroup=small&reported=false&viewableOnly="+(!isMod).toString(),true);request.setRequestHeader('Accept','application/hal+json');request.withCredentials=!0;request.send();}function createDiscussionsFeed(){if(wgNamespaceNumber==-1&&wgTitle=="DiscussionsFeed"){document.title='Discussions Feed - '+wgSiteName;var canBlock=Boolean(wgUserGroups.indexOf('sysop')>-1||wgUserGroups.indexOf('staff')>-1||wgUserGroups.indexOf('helper')>-1||wgUserGroups.indexOf('vstf')>-1||wgUserGroups.indexOf('global-discussions-moderator')>-1),isMod=Boolean(canBlock||wgUserGroups.indexOf('threadmoderator')>-1);if(window.skin=="oasis"){document.getElementById("PageHeader").getElementsByTagName("h1")[0].textContent="Discussions Feed";}else if(window.skin=="monobook"){document.getElementById("firstHeading").textContent="Discussions Feed";}var content=document.getElementById("mw-content-text");content.innerHTML=
'Loading feed... <img src="https://images.wikia.nocookie.net/wlb/images/7/74/WIP.gif" /></div>';initFeed(content,isMod,canBlock);}}{var j=-1;for(var i=0;i<onloadFuncts.length&&j<0;i++){if(onloadFuncts[i].name=="createDiscussionsFeed"){j=i;}}if(j<0){addOnloadHook(createDiscussionsFeed);}};if(typeof CRA==="undefined"){CRA={supportedLanguages:['en','ar','be','ca','cs','de','el','es','fr','fy','gl','hi','hr','it','kn','ko','nl','oc','pl','pt','pt-br','ro','ru','sr','tr','uk','val','zh'],i18n:{en:{categoryNamespace:'Category'}},lang:'',userLang:'',started:!1,delay:1000,updateStatus:function(gifDisplay,message){if($("#CRAStatus").length===0)return false;if(typeof gifDisplay==="string"){message=gifDisplay;}else if(typeof gifDisplay==="boolean"){if(gifDisplay===false){displayValue="none";}else{displayValue="inline-block";}document.getElementById("liveLoader").style.display=displayValue;}else{return false;}if(typeof message==="string"){$("#CRAStatus").html(" "+message);}return true;},
updateProgress:function(show,progress){if(typeof progress=="undefined"&&typeof show=="boolean")progress=0;if(typeof progress=="undefined"&&typeof show=="number")progress=show;if(typeof show=="boolean"){if(show)$('.mw-submit:has("#CRAStatus")').append("<div id='CRAQueueProgress' style='float: right; width: 200px; border: 2px solid black; height: 17px;'><div id='CRAProgressInd' style='width: 0%; height: 100%; float: left; background-color: green;'></div></div>");else $("#CRAQueueProgress").remove();}if(typeof progress=="number"){$("#CRAProgressInd").css("width",((progress*100)+"%"));return;}},start:function(type){CRA.rand=Math.floor(Math.random()*1000);if(CRA.started===true){return false;}if(document.getElementById("CRADeleteRadio").checked!==true&&document.getElementById("CRARedirectRadio").checked!==true&&document.getElementById("CRANothingRadio").checked!==true&&document.getElementById("CRAReplaceRadio").checked!==true){CRA.updateStatus(false,CRA.userLang.chooseOldPage);return false;}
CRA.started=!0;CRA.updateStatus(true,CRA.userLang.checkingNewTitle);CRA.oldName=decodeURIComponent($.getUrlVar('categoryname').replace(/_/g," ")).replace(/%22/g,'"').replace(/%27/g,"'"),CRA.newName=document.getElementById("wpNewTitleMain").value,CRA.reason=$("#wpReason").val();CRA.pageKey=[];CRA.pageData=[];CRA.queueData=[];CRA.requestCompleted=[];CRA.oldCategoryContent="";if(localStorage[wgUserName+"_CRANamespaceSelection"]===false){var namespaceSelection="&blnamespace=0";}else{var namespaceSelection="";}$.getJSON(mw.util.wikiScript("api")+"?action=query&prop=revisions&rvprop=content&titles="+CRA.lang.categoryNamespace+":"+encodeURIComponent(CRA.newName.replace(/ /g,"_")).replace(/"/g,"%22").replace(/'/g,"%27")+"&format=json&v="+CRA.rand,function(result){if(typeof result.query.pages[-1]!=="undefined"){CRA.updateStatus(true,CRA.userLang.gettingCatMembers);$.getJSON(mw.util.wikiScript("api")+"?action=query&list=categorymembers&cmtitle="+CRA.lang.categoryNamespace+":"+
encodeURIComponent(CRA.oldName.replace(/ /g,"_")).replace(/"/g,"%22").replace(/'/g,"%27")+"&cmprop=title&cmlimit=5000&format=json&v="+CRA.rand,function(result){var categoryUsage=result.query.categorymembers;$.getJSON(mw.util.wikiScript("api")+"?action=query"+namespaceSelection+"&list=backlinks&bltitle="+CRA.lang.categoryNamespace+":"+encodeURIComponent(CRA.oldName.replace(/ /g,"_")).replace(/"/g,"%22").replace(/'/g,"%27")+"&format=json&v="+CRA.rand,function(result){var categoryLinks=result.query.backlinks;var totalCatUsage=categoryUsage.concat(categoryLinks);if(console)console.log("Category usage successfully retrieved");if(totalCatUsage.length>0){for(var currentPage=0;currentPage<totalCatUsage.length;currentPage++){var title=totalCatUsage[currentPage].title;if(CRA.pageKey.indexOf(title)==-1){CRA.pageKey[CRA.pageKey.length]=title;}}CRA.updateStatus(true,CRA.userLang.fetchingContents);CRA.processPageContent(function(){CRA.updateStatus(true,CRA.userLang.creatingNewPage);CRA.createNewPage
(function(){CRA.updateStatus(true,CRA.userLang.submittingPages);if(console)console.log("Begin submitting pages");CRA.updateProgress(true);CRA.queueProgress=0;var l=0;var throttle=setInterval(function(){CRA.submitChangedPages(l,function(){var completeMessage=CRA.userLang.renameComplete+': <a href="'+mw.config.get('wgScriptPath')+'/wiki/'+CRA.lang.categoryNamespace+':'+encodeURIComponent(CRA.newName.replace(/ /g,"_")).replace(/"/g,"%22").replace(/'/g,"%27")+'">'+CRA.newName+'</a>.';if(document.getElementById("CRADeleteRadio").checked===true){CRA.deleteOldPage(function(){CRA.updateStatus(false,completeMessage);CRA.updateProgress(false);});}else if(document.getElementById("CRARedirectRadio").checked===true){CRA.replaceOldContents("#REDIRECT [[:"+CRA.lang.categoryNamespace+":"+CRA.newName+"]]",CRA.lang.redirToNew+" → [["+CRA.lang.categoryNamespace+":"+CRA.newName+"]] ("+CRA.lang.automatic+")",function(){CRA.updateStatus(false,completeMessage);CRA.updateProgress(false);});}else if(document
.getElementById("CRAReplaceRadio").checked){CRA.replaceOldContents($("#CRAReplaceText").val(),CRA.reason+" ("+CRA.lang.automatic+")",function(){CRA.updateStatus(false,completeMessage);CRA.updateProgress(false);});}else{CRA.updateStatus(false,completeMessage);CRA.updateProgress(false);}});l++;if(l==CRA.pageData.length){clearInterval(throttle);}},(CRAoptions.delay||CRA.delay));});});}else{CRA.started=!1;CRA.updateStatus(false,CRA.userLang.catNotUsed);}});});}else{CRA.started=!1;CRA.updateStatus(false,CRA.userLang.destExists);}});},createNewPage:function(callback){$.ajax({url:mw.util.wikiScript("api"),type:"POST",async:!0,data:{action:"edit",title:CRA.lang.categoryNamespace+":"+CRA.newName,summary:CRA.reason+" ("+CRA.lang.automatic+")",text:CRA.oldCategoryContent,minor:!0,recreate:!0,createonly:!0,bot:!0,token:mediaWiki.user.tokens.get("editToken"),format:"json"},contentType:"application/x-www-form-urlencoded",error:function(){alert(CRA.userLang.unableToCreate+" \""+CRA.
newName+"\".");CRA.started=!1;},success:function(result){if(console)console.log(CRA.userLang.createdNewCat+" \""+CRA.newName+"\"");if(typeof result.error!=="undefined"){CRA.failedLogCustom(CRA.userLang.pageNotCreated[0]+" \""+CRA.newName+"\" "+CRA.userLang.pageNotCreated[1]+":\""+result.error.code+"; "+result.error.info+"\".");return false;}if(typeof(callback)==="function"){callback();}}});},processPageContent:function(callback){if(console)console.log("Start processing page content");for(i=0;i<CRA.pageKey.length;i++){CRA.requestCompleted[i]=!1;}if(console)console.log("Getting page contents");$.post(mw.util.wikiScript("api"),{action:"query",prop:"revisions",rvprop:"content",titles:CRA.pageKey.join("|")+"|"+CRA.lang.categoryNamespace+":"+CRA.oldName,format:"json",v:CRA.rand},function(result){var oldCatExists=!1;for(var i in result.query.pages){if(typeof result.query.pages[i].missing!='undefined')continue;var keyNum=CRA.pageKey.indexOf(result.query.pages[i].title);if(result.query
.pages[i].title==CRA.lang.categoryNamespace+":"+CRA.oldName){CRA.oldCategoryContent=(result.query.pages[i].revisions[0]["*"]!==""?result.query.pages[i].revisions[0]["*"]:".");oldCatExists=!0;}else{CRA.pageData[keyNum]={title:CRA.pageKey[keyNum],content:result.query.pages[i].revisions[0]["*"],};}}if(!oldCatExists)CRA.oldCategoryContent=".";if(console)console.log("Page contents retrieved and saved");if(console)console.log("Begin processing page content.");for(i=0;i<CRA.pageData.length;i++){var escapedName0=CRA.oldName.replace(/\*/g,"\\*").replace(/\?/g,"\\?").replace(/\./g,"\\.").replace(/ /g,"[ _]*?").replace(/\(/g,"\\(").replace(/\)/g,"\\)");if(escapedName0.substr(0,1).match(/[A-z]/i)){var escapedName="["+escapedName0.substr(0,1).toUpperCase()+escapedName0.substr(0,1).toLowerCase()+"]"+escapedName0.substr(1);}else{var escapedName=escapedName0;}var pageReplacement=new RegExp("(\\[:?("+CRA.lang.categoryNamespace+"|"+CRA.i18n.en.categoryNamespace+"):[ ]*?)"+escapedName+"(\\]|[ ]*?\\|)",
"g");var replacementReg=new RegExp(escapedName,"g");var regExec;if(CRA.pageData[i].content.search(pageReplacement)!=-1){while((regExec=pageReplacement.exec(CRA.pageData[i].content))!==null){CRA.pageData[i].content=CRA.pageData[i].content.replace(regExec[0],regExec[0].replace(replacementReg,CRA.newName));pageReplacement.lastIndex+=(regExec[0].replace(replacementReg,CRA.newName).length-regExec[0].length)-(regExec[3].length);}}else{CRA.failedLogCustom(CRA.lang.unableToFind[0]+" \""+CRA.oldName+"\" "+CRA.lang.unableToFind[1]+" \""+CRA.pageData[i].title+"\""+CRA.lang.unableToFind[2]);}}if(typeof(callback)==="function"){callback();}},"json");},submitChangedPages:function(pageKey,callback){$.ajax({url:mw.util.wikiScript("api"),type:"POST",async:!0,data:{action:"edit",title:CRA.pageData[pageKey].title,summary:CRA.lang.updating+" "+CRA.lang.categoryNamespace+":"+CRA.oldName+" → [["+CRA.lang.categoryNamespace+":"+CRA.newName+"]] ("+CRA.lang.automatic+")",text:CRA.pageData[pageKey].content,
minor:!0,nocreate:!0,redirect:!1,bot:!0,token:mediaWiki.user.tokens.get("editToken"),format:"json"},contentType:"application/x-www-form-urlencoded",error:function(){CRA.requestCompleted[pageKey]=!0;CRA.queueProgress++;CRA.updateProgress(CRA.queueProgress/CRA.pageData.length);alert("Unable to publish page \""+CRA.pageKey[pageKey]+"\".  Please rename categories on that page manually.");if(CRA.requestCompleted.indexOf(false)==-1){if(typeof(callback)==="function"){callback();}}},success:function(result){CRA.requestCompleted[pageKey]=!0;CRA.queueProgress++;CRA.updateProgress(CRA.queueProgress/CRA.pageData.length);if(console)console.log("Posted page \""+CRA.pageKey[pageKey]+"\"");CRA.updateStatus(true,CRA.userLang.submittedPage+" \""+CRA.pageData[pageKey].title+"\"");if(typeof result.error!=="undefined"){CRA.failedLogCustom(CRA.userLang.pageNotSubmitted[0]+" \""+CRA.pageData[pageKey].title+"\" "+CRA.userLang.pageNotSubmitted[1]+":\""+result.error.code+"; "+result.error.info+
"\". "+CRA.userLang.pageNotSubmitted[2]+".");}if(CRA.requestCompleted.indexOf(false)==-1){if(typeof(callback)==="function"){callback();}}}});},deleteOldPage:function(callback){$.ajax({url:mw.util.wikiScript("api"),type:"POST",async:!0,data:{action:"delete",title:CRA.lang.categoryNamespace+":"+CRA.oldName,reason:CRA.reason+" ("+CRA.lang.automatic+")",token:mediaWiki.user.tokens.get("editToken"),format:"json",bot:!0},contentType:"application/x-www-form-urlencoded",error:function(){alert("Unable to delete category \""+CRA.newName+"\".  Please delete manually.");CRA.started=!1;if(typeof(callback)==="function"){callback();}},success:function(result){if(console)console.log("Deleted category page \""+CRA.newName+"\"");if(typeof result.error!=="undefined"){CRA.failedLogCustom(CRA.userLang.pageNotDeleted[0]+" \""+CRA.lang.categoryNamespace+":"+CRA.oldName+"\" "+CRA.userLang.pageNotDeleted[1]+":\""+result.error.code+"; "+result.error.info+"\".  "+CRA.userLang.pageNotDeleted[2]+".");}if(
typeof(callback)==="function"){callback();}}});},redirectOldPage:function(callback){$.ajax({url:mw.util.wikiScript("api"),type:"POST",async:!0,data:{action:"edit",title:CRA.lang.categoryNamespace+":"+CRA.oldName,summary:CRA.lang.redirToNew+" → [["+CRA.lang.categoryNamespace+":"+CRA.newName+"]] ("+CRA.lang.automatic+")",text:"#REDIRECT [[:"+CRA.lang.categoryNamespace+":"+CRA.newName+"]]",minor:!0,nocreate:!0,redirect:!1,bot:!0,token:mediaWiki.user.tokens.get("editToken"),format:"json"},contentType:"application/x-www-form-urlencoded",error:function(){alert("Unable to publish page \""+CRA.oldName+"\".  Please update that page manually.");if(typeof(callback)==="function"){callback();}},success:function(result){if(console)console.log("Posted page \""+CRA.oldName+"\"");if(typeof result.error!=="undefined"){CRA.failedLogCustom(CRA.userLang.pageNotSubmitted[0]+" \""+CRA.oldName+"\" "+CRA.userLang.pageNotSubmitted[1]+":\""+result.error.code+"; "+result.error.info+"\". "+CRA.
userLang.pageNotSubmitted[2]+".");}if(typeof(callback)==="function"){callback();}}});},replaceOldContents:function(text,reason,callback){$.ajax({url:mw.util.wikiScript("api"),type:"POST",async:!0,data:{action:"edit",title:CRA.lang.categoryNamespace+":"+CRA.oldName,summary:reason,text:text,minor:!0,nocreate:!0,redirect:!1,bot:!0,token:mediaWiki.user.tokens.get("editToken"),format:"json"},contentType:"application/x-www-form-urlencoded",error:function(){alert("Unable to publish page \""+CRA.oldName+"\".  Please update that page manually.");if(typeof(callback)==="function"){callback();}},success:function(result){if(console)console.log("Posted page \""+CRA.oldName+"\"");if(typeof result.error!=="undefined"){CRA.failedLogCustom(CRA.userLang.pageNotSubmitted[0]+" \""+CRA.oldName+"\" "+CRA.userLang.pageNotSubmitted[1]+":\""+result.error.code+"; "+result.error.info+"\". "+CRA.userLang.pageNotSubmitted[2]+".");}if(typeof(callback)==="function"){callback();}}});},
updateNamespaceSelection:function(){if(document.getElementById("CRANamespaceToggleCheck").checked===true){localStorage[wgUserName+"_CRANamespaceSelection"]="checked";}else{localStorage[wgUserName+"_CRANamespaceSelection"]="";}},failedLogCustom:function(text){if(typeof(CRA.logFailed)==="undefined"){CRA.logFailed="";}CRA.logFailed+="<div>"+text+"</div>";if($("#CRAFailedLog").length>0){document.getElementById("CRAFailedLog").innerHTML=CRA.logFailed;$("#CRAFailedLog div:odd").css("background-color","red");}},initialize:function(){window.CRAoptions=window.CRAoptions||{};if(typeof CRA.supportedLanguages.indexOf(mediaWiki.config.get('wgContentLanguage'))==-1){if(mw.config.get('wgAction')=='view'&&mw.config.get('wgNamespaceNumber')==14){$('.page-header__contribution-buttons .wds-list').append($('<li/>').append($('<a/>',{'href':'https://dev.wikia.com/wiki/Talk:CategoryRenameAuto-update','title':'Request/provide translations','html':'CRA lang not supported'})));}}else{if(typeof localStorage[
wgUserName+"_CRANamespaceSelection"]==="undefined"){localStorage[wgUserName+"_CRANamespaceSelection"]="";}if(typeof CRA.supportedLanguages.indexOf(mediaWiki.config.get('wgUserLanguage'))==-1){var userLang="en";}else{var userLang=mediaWiki.config.get('wgUserLanguage');}if(mw.config.get('wgCanonicalSpecialPageName')==='Blankpage'&&$.getUrlVar('blankspecial')==='categoryrename')$('#WikiaArticle').html('<div style="text-align: center; margin-top: 40px;"><img style="margin-bottom: 7px;" src="https://images.wikia.nocookie.net/common/skins/common/progress-wheel.gif" /><span style="font-weight: bold; font-size: 20px; padding-left: 10px;">Loading language "'+mediaWiki.config.get('wgContentLanguage')+'"...</span></div>');$.ajax({url:"https://dev.wikia.com/wiki/CategoryRenameAuto-update/"+mediaWiki.config.get('wgContentLanguage')+".js?action=raw&ctype=text/javascript",dataType:"script",cache:!0,success:function(){if(console)mw.log('CategoryRenameAuto-update: Loaded language pack '+mediaWiki.
config.get('wgContentLanguage'));CRA.lang=CRA.i18n[mediaWiki.config.get('wgContentLanguage')];if(userLang!=mediaWiki.config.get('wgContentLanguage')){$.ajax({url:"https://dev.wikia.com/wiki/CategoryRenameAuto-update/"+userLang+".js?action=raw&ctype=text/javascript",dataType:"script",cache:!0,success:function(){if(console)mw.log('CategoryRenameAuto-update: Loaded secondary language pack '+userLang);CRA.userLang=CRA.i18n[userLang];CRA.makeUI();}});}else{CRA.userLang=CRA.lang;CRA.makeUI();}},error:function(){console.log("Could not load language pack "+mediaWiki.config.get('wgUserLanguage'));}});}},makeUI:function(){(function($,mw){'use strict';$(function(){if(mw.config.get('wgAction')!=='view'||mw.config.get('wgNamespaceNumber')!==14){return;}$('.page-header__contribution-buttons .wds-list').append($('<li/>').append($('<a/>',{'href':wgArticlePath.replace('$1','Special:Blankpage?blankspecial=categoryrename&categoryname=')+encodeURIComponent(mw.config.get('wgTitle').replace(/ /g,"_")).
replace(/"/g,"%22").replace(/'/g,"%27"),'title':CRA.userLang.rename,'text':CRA.userLang.rename})));}());if(mw.config.get('wgCanonicalSpecialPageName')==='Blankpage'&&$.getUrlVar('blankspecial')==='categoryrename'){var decodedOldCat=decodeURIComponent($.getUrlVar('categoryname').replace(/_/g," ")).replace(/%22/g,'"').replace(/%27/g,"'");var createCategoryRenameForm=function(){var linkToOldCat=wgArticlePath.replace('$1',CRA.lang.categoryNamespace+':'+$.getUrlVar('categoryname'));var form='<div class="AdminDashboardGeneralHeader AdminDashboardArticleHeader"><h1>'+CRA.userLang.renamingCat+': '+decodedOldCat+'</h1></div>'+CRA.userLang.mainDescription+'<br />'+'<fieldset><legend>'+CRA.userLang.renameFieldset+'</legend><table border="0" id="mw-renamecategory-table"><tr><td class="mw-label">'+CRA.userLang.currentName+':</td><td class="mw-input"><strong><a href="'+linkToOldCat+'">'+CRA.lang.categoryNamespace+':'+decodedOldCat+'</a></strong></td></tr>'+'<tr><td class="mw-label">'+CRA.userLang.
renameFieldset+':</td><td class="mw-input"><strong>'+CRA.lang.categoryNamespace+':</strong><input name="wpNewTitleMain" size="79.5" value="'+decodedOldCat+'" type="text" id="wpNewTitleMain" maxlength="255"></td></tr>'+'<tr><td class="mw-label">'+CRA.userLang.reason+':</td><td class="mw-input"><textarea name="wpReason" id="wpReason" cols="60" rows="2" maxlength="255"></textarea></td></tr>'+'<tr><td>&#160;</td><td class="mw-submit"><div id="CRANamespaceToggle" style="margin: 5px 5px 5px 0px;"><label><input type="checkbox" id="CRANamespaceToggleCheck" onchange="CRA.updateNamespaceSelection()" '+localStorage[wgUserName+"_CRANamespaceSelection"]+'>'+CRA.userLang.includeLinks+'</label></div><label><input type="radio" name="options" value="redirect" id="CRARedirectRadio">'+CRA.userLang.leaveRedir+'</label><br /><label><input type="radio" name="options" value="delete" id="CRADeleteRadio">'+CRA.userLang.deleteOldCat+
'</label><br /><label><input type="radio" name="options" value="replace" id="CRAReplaceRadio">'+CRA.userLang.replaceOldContents+':</label> <input type="text" size="15" id="CRAReplaceText"><br /><label><input type="radio" name="options" value="nothing" id="CRANothingRadio">'+CRA.userLang.doNothing+'</label></td></tr><tr><td>&#160;</td><td class="mw-submit"><a style="margin-left: 0px;" class="wikia-button" onclick="CRA.start()">'+CRA.userLang.rename+'</a><span id="liveLoader" style="display:none"><img src="https://images.wikia.nocookie.net/common/skins/common/progress-wheel.gif" /></span><span id="CRAStatus" style="font-weight: bold"></span></td></tr>'+'<tr><td class="mw-label">'+CRA.userLang.failedItems+':</td><td class="mw-input"><div id="CRAFailedLog" style="width: 798px; margin: 5px auto 0px auto; background-color: #ffbfbf; height: 150px; border: 1px solid black; font-weight: bold; overflow: scroll; color: #3a3a3a;">'+CRA.userLang.failedDescription+'</div></td></tr>';$(
'#WikiaArticle').html(form);};document.title=CRA.userLang.pageTitle;createCategoryRenameForm();}}(window.jQuery,window.mediaWiki));}};CRA.initialize();};(function($,mw){if(window.QuickIWLoaded){return;}window.QuickIWLoaded=!0;var QuickIW={page:mw.config.get('wgPageName'),preload:function(i18n){$.when(i18n.loadMessages('QuickIW'),mw.loader.using(['mediawiki.api','mediawiki.user','mediawiki.util'])).then($.proxy(this.init,this));},init:function(i18n){this.i18n=i18n;this.api=new mw.Api();$('.page-header__contribution-buttons .wds-list').append($('<li>').append($('<a>',{click:$.proxy(this.click,this),id:'QuickIW',text:i18n.msg('interwiki').plain()})));},click:function(){$.showCustomModal(this.i18n.msg('interwiki').escape(),$('<form>').append($('<div>').append($('<label>',{'for':'QuickIWLanguage','text':this.i18n.msg('language').plain()}),$('<input>',{id:'QuickIWLanguage',name:'QuickIWLanguage',type:'text'})),$('<div>').append($('<label>',{'for':'QuickIWPage','text':this.i18n.msg('page').
plain()}),$('<input>',{id:'QuickIWPage',name:'QuickIWPage',type:'text'}).attr('placeholder',this.page)),$('<div>').append($('<label>',{'for':'QuickIWSummary','text':this.i18n.msg('summary').plain()}),$('<input>',{id:'QuickIWSummary',name:'QuickIWSummary',type:'text'}).attr('placeholder',this.i18n.inContentLang().msg('placeholder').plain()))),{id:'QuickIWModal',buttons:[{defaultButton:!0,message:this.i18n.msg('add').escape(),handler:$.proxy(this.edit,this)}]});},edit:function(){var language=$('#QuickIWLanguage').val(),$summary=$('#QuickIWSummary');if(!language||this.editing){return;}this.editing=!0;this.api.post({action:'edit',title:this.page,summary:$summary.val()||$summary.attr('placeholder'),appendtext:'\n[['+language+':'+($('#QuickIWPage').val()||this.page)+']]',token:mw.user.tokens.get('editToken'),minor:!0,bot:!0}).then($.proxy(this.callback,this)).fail($.proxy(this.fail,this));},callback:function(d){if(d.error){this.editing=!1;this.error(d.error.code);}else{window.
location.href=mw.util.getUrl(this.page,{action:'purge'});}},fail:function(){this.editing=!1;this.error(this.i18n.msg('ajax-error').plain());},error:function(text){new BannerNotification(this.i18n.msg('error',text).escape(),'error').show();}};if(!window.dev||!window.dev.i18n){importArticle({type:'script',article:'u:dev:MediaWiki:I18n-js/code.js'});}importArticle({type:'style',article:'u:dev:MediaWiki:QuickIW.css'});mw.hook('dev.i18n').add($.proxy(QuickIW.preload,QuickIW));}(jQuery,mediaWiki));;(function(){'use strict'
if(!window.rcstats){window.rcstats={onLoad:function(){mw.log('window.rcstats.onLoad')
if(window.rcstats.isStatsPage()){document.getElementById('mw-content-text').innerHTML='<svg class="wds-spinner wds-spinner__block" width="45" height="45" viewBox="0 0 45 45" xmlns="http://www.w3.org/2000/svg"><g transform="translate(22.5, 22.5)"><circle class="wds-spinner__stroke" fill="none" stroke-width="5" stroke-dasharray="125.66370614359172" stroke-dashoffset="125.66370614359172" stroke-linecap="round" r="20"></circle></g></svg>'}if(!mw.loader.getState('rcstats.i18n')){mw.loader.implement('rcstats.i18n',['/load.php?mode=articles&only=scripts&articles=u:dev:I18n-js/code.js'],{},{})}mw.loader.using(['rcstats.i18n','mediawiki.api','mediawiki.util'],function(){window.dev.i18n.loadMessages('RCStats').done(function(i18n){window.rcstats.i18n=i18n
window.rcstats.init()})})},init:function(){mw.log('window.rcstats.init')
mw.hook('rcstats.init').fire()
window.rcstats.createLink()
if(window.rcstats.isStatsPage()){window.rcstats.loadPage()}},createLink:function(){mw.log('window.rcstats.createLink')
var text=window.rcstats.i18n.msg('shortName').plain()
var href=mw.util.getUrl('Special:Blankpage',{'blankspecial':'rcstats'})
var elem=document.createElement('li')
var link=document.createElement('a')
link.appendChild(document.createTextNode(text))
link.setAttribute('href',href)
elem.appendChild(link)
document.querySelector('.wds-community-header__wiki-buttons > .wds-dropdown > .wds-dropdown__content > .wds-list').appendChild(elem)
mw.hook('rcstats.link').fire({elem:elem,text:text,href:href})},loadPage:function(){mw.log('window.rcstats.loadPage')
importArticle({type:'style',article:'u:dev:MediaWiki:RCStats.css',loaded:function(){window.sectionsData=[]
mw.loader.using(['ext.hydralytics.scripts'],function(){window.rcstats.generateStatsPage()
window.rcstats.request(null,[],new mw.Api(),500,new Date(new Date().setHours(25,0,0,0)-1000*60*60*24*7))})}})},request:function(rcstart,fetchedData,api,requestSize,furthestDate){api.get({action:'query',list:'recentchanges',rcprop:['user','timestamp','title','loginfo','flags'].join('|'),rclimit:500,rcstart:rcstart,maxage:86400,smaxage:86400}).done(function(data){var newData=fetchedData.concat(data.query.recentchanges.filter(function(entry){return new Date(entry.timestamp)>=furthestDate}))
if(data.query.recentchanges.length<requestSize){window.rcstats.requestsFinished(newData)
return}var furthestEntry=data.query.recentchanges[requestSize-1]
if(new Date(furthestEntry.timestamp)>=furthestDate){window.rcstats.request(data['query-continue'].recentchanges.rcstart,newData,api,requestSize,furthestDate)}else{window.rcstats.requestsFinished(newData)}})},requestsFinished:function(fetchedData){mw.log('window.rcstats.requestsFinished')
window.rcstats.data=fetchedData.map(function(entry){return{type:window.rcstats.getPageType(entry.ns),timestamp:new Date(entry.timestamp),user:entry.user,bot:entry.bot!==undefined,minor:entry.minor!==undefined}}).reverse()
window.rcstats.createCharts()},generateStatsPage:function(){mw.log('window.rcstats.generateStatsPage')
document.querySelector('#PageHeader .page-header__title').textContent=window.rcstats.i18n.msg('name').plain()
document.title=window.rcstats.i18n.msg('name').plain()+' | '+mw.config.get('wgSiteName')
var mwContentText=document.getElementById('mw-content-text')
while(mwContentText.lastChild){mwContentText.removeChild(mwContentText.lastChild)}var docFrag=document.createDocumentFragment()
var mainElem=document.createElement('main')
mainElem.classList.add('rcstats');['users','days','pages'].forEach(function(sectionName){var sectionElem=document.createElement('section')
sectionElem.classList.add('rcsection')
var sectionTitle=document.createElement('h2')
sectionTitle.appendChild(document.createTextNode(window.rcstats.i18n.msg(sectionName).plain()))
sectionElem.appendChild(sectionTitle)
var chartWrapper=document.createElement('div')
chartWrapper.classList.add('rccanvaswrapper')
var canvasElem=document.createElement('canvas')
canvasElem.id='rcstats-'+sectionName
canvasElem.setAttribute('width',10)
canvasElem.setAttribute('height',9)
chartWrapper.appendChild(canvasElem)
sectionElem.appendChild(chartWrapper)
mainElem.appendChild(sectionElem)})
docFrag.appendChild(mainElem)
var filtersElem=document.createElement('section')
var mainFieldset=document.createElement('fieldset')
mainFieldset.classList.add('rcfilters');['article','social','user','media','code','other'].forEach(function(catName){var labelElem=document.createElement('label')
var checkbox=document.createElement('input')
checkbox.setAttribute('type','checkbox')
checkbox.setAttribute('data-type',catName)
checkbox.checked=!0
checkbox.disabled=!0
labelElem.appendChild(checkbox)
labelElem.appendChild(document.createTextNode(window.rcstats.i18n.msg(catName).plain()))
mainFieldset.appendChild(labelElem)})
filtersElem.appendChild(mainFieldset)
var secondaryFieldset=document.createElement('fieldset')
secondaryFieldset.classList.add('rcfilters')
var botsLabel=document.createElement('label')
var botsCheckbox=document.createElement('input')
botsCheckbox.setAttribute('type','checkbox')
botsCheckbox.setAttribute('data-bots',true)
botsCheckbox.checked=!1
botsCheckbox.disabled=!0
botsLabel.appendChild(botsCheckbox)
botsLabel.appendChild(document.createTextNode(window.rcstats.i18n.msg('bots').plain()))
secondaryFieldset.appendChild(botsLabel)
var minorLabel=document.createElement('label')
var minorCheckbox=document.createElement('input')
minorCheckbox.setAttribute('type','checkbox')
minorCheckbox.setAttribute('data-minor',true)
minorCheckbox.checked=!0
minorCheckbox.disabled=!0
minorLabel.appendChild(minorCheckbox)
minorLabel.appendChild(document.createTextNode(window.rcstats.i18n.msg('showMinor').plain()))
secondaryFieldset.appendChild(minorLabel)
filtersElem.appendChild(secondaryFieldset)
docFrag.appendChild(filtersElem)
var footerElem=document.createElement('footer')
footerElem.classList.add('rcfooter')
footerElem.appendChild(document.createTextNode(window.rcstats.i18n.msg('nodata').plain()))
docFrag.appendChild(footerElem)
mwContentText.appendChild(docFrag)
new mw.Api().get({action:'parse',text:'{{int:statistics-footer}}',prop:'text'}).done(function(data){var elem=document.createElement('template')
elem.innerHTML=data.parse.text['*']
elem.content.querySelector('.editsection').remove()
mwContentText.appendChild(elem)})},createCharts:function(){mw.log('window.rcstats.createCharts')
window.rcstats.updateFooter(window.rcstats.data)
if(window.rcstats.data.length===0){return}var dicts=window.rcstats.getEditDicts(window.rcstats.data)
var usersChartData=window.rcstats.getUsersChartData(dicts.editsByUsers)
window.rcstats.charts.users=new Chart(document.getElementById('rcstats-users').getContext('2d'),{type:'doughnut',data:{datasets:usersChartData.datasets,labels:usersChartData.labels},options:{legend:{display:!1},tooltips:{displayColors:!1}}})
document.getElementById('rcstats-users').addEventListener('click',function(e){var elem=window.rcstats.charts.users.getElementsAtEvent(e)[0]
if(elem===undefined){return}window.open(mw.util.getUrl('Special:Contributions/'+window.rcstats.charts.users.data.labels[elem._index]))})
var daysChartData=window.rcstats.getDaysChartData(dicts.editsByDays)
window.rcstats.charts.days=new Chart(document.getElementById('rcstats-days').getContext('2d'),{type:'line',data:{datasets:daysChartData.datasets,labels:daysChartData.labels},options:{scales:{xAxes:[{ticks:{autoSkip:!1}}],yAxes:[{ticks:{beginAtZero:!0}}]},tooltips:{mode:'index',intersect:!1},hover:{mode:'nearest'}}})
var pagesChartData=window.rcstats.getPagesChartData(dicts.editsByType)
window.rcstats.charts.pages=new Chart(document.getElementById('rcstats-pages').getContext('2d'),{type:'bar',data:{datasets:pagesChartData.datasets,labels:pagesChartData.labels},options:{tooltips:{displayColors:!1},scales:{xAxes:[{stacked:!0,ticks:{autoSkip:!1}}],yAxes:[{stacked:!0,ticks:{beginAtZero:!0}}]}}})
Array.from(document.querySelectorAll('.rcfilters input[type=checkbox][data-type]')).forEach(function(check){if(window.rcstats.data.filter(function(rev){return rev.type===check.getAttribute('data-type')}).length===0){check.parentNode.remove()}else{check.removeAttribute('disabled')}})
if(window.rcstats.data.filter(function(rev){return rev.bot}).length===0){document.querySelector('.rcfilters input[type=checkbox][data-bots]').parentNode.remove()}else{document.querySelector('.rcfilters input[type=checkbox][data-bots]').removeAttribute('disabled')}if(window.rcstats.data.filter(function(rev){return rev.minor}).length===0){document.querySelector('.rcfilters input[type=checkbox][data-minor]').parentNode.remove()}else{document.querySelector('.rcfilters input[type=checkbox][data-minor]').removeAttribute('disabled')}Array.from(document.querySelectorAll('.rcfilters input[type=checkbox]')).forEach(function(check){check.addEventListener('change',function(){window.rcstats.updateFilter()})})
window.rcstats.updateFilter()},getPageType:function(ns){if([0,4,5,14,15].includes(ns)){return'article'}else if([-2,6,7].includes(ns)){return'media'}else if([8,9,10,11,828,829].includes(ns)){return'code'}else if([1,3,110,111,500,501,502,503,1200,1201,2000,2001,2002].includes(ns)){return'social'}else if([2,1202].includes(ns)){return'user'}else{return'other'}},getEditDicts:function(data){var editsByUsers={}
var editsByDays={}
var editsByType={}
Object.entries(data).forEach(function(entry){if(editsByUsers[entry[1].user]){editsByUsers[entry[1].user]+=1}else{editsByUsers[entry[1].user]=1}var date=entry[1].timestamp
var day=date.getFullYear()+'-'+(date.getMonth()+1).toString().padStart(2)+'-'+date.getDate().toString().padStart(2)
if(editsByDays[day]){editsByDays[day].edits+=1
if(!editsByDays[day].users.includes(entry[1].user)){editsByDays[day].users.push(entry[1].user)}}else{var weekday=date.toLocaleString(window.navigator.language||'en-EN',{weekday:'long'})
editsByDays[day]={edits:1,day:weekday.charAt(0).toUpperCase()+weekday.slice(1),users:[entry[1].user]}}if(editsByType[entry[1].type]){editsByType[entry[1].type].minor+=entry[1].minor?1:0
editsByType[entry[1].type].major+=entry[1].minor?0:1}else{editsByType[entry[1].type]={minor:entry[1].minor?1:0,major:entry[1].minor?0:1}}})
return{editsByUsers:editsByUsers,editsByDays:editsByDays,editsByType:editsByType}},getUsersChartData:function(editsByUsers,filter){var usersData=[]
var usersLabels=[]
var usersColors=[]
var usersHoverColors=[]
var usersBorders=window.sassParams['color-page']
Object.entries(editsByUsers).sort(function(a,b){return b[1]-a[1]}).filter(function(e){return filter?filter(e[1]):!0}).forEach(function(e){usersData.push(e[1])
usersLabels.push(e[0])
var hue=((Array.from(e[0]).reduce(function(s,c){return Math.imul(31,s)+c.charCodeAt(0)|0},0)+2147483647)/4294967295)*360
if(window.rcstats.charts.users&&window.rcstats.charts.users.data.labels&&window.rcstats.charts.users.data.datasets[0]){var id=Object.entries(window.rcstats.charts.users.data.labels).find(function(dataE){return dataE[1]===e[0]})
if(id){usersColors.push(window.rcstats.charts.users.data.datasets[0].backgroundColor[id[0]])
usersHoverColors.push(window.rcstats.charts.users.data.datasets[0].hoverBackgroundColor[id[0]])}else{usersColors.push('hsl('+hue+', 80%, 50%)')
usersHoverColors.push('hsl('+hue+', 80%, 25%)')}}else{usersColors.push('hsl('+hue+', 80%, 50%)')
usersHoverColors.push('hsl('+hue+', 80%, 25%)')}})
return{datasets:[{data:usersData,backgroundColor:usersColors,hoverBackgroundColor:usersHoverColors,borderColor:usersBorders,hoverBorderColor:usersBorders}],labels:usersLabels}},getDaysChartData:function(editsByDays){var daysEditsData=[]
var daysUsersData=[]
var daysLabels=[]
Object.values(editsByDays).forEach(function(v){daysEditsData.push(v.edits)
daysUsersData.push(v.users.length)
daysLabels.push(v.day)})
return{datasets:[{label:window.rcstats.i18n.msg('edits').plain(),data:daysEditsData,backgroundColor:'#00d6d6',borderColor:'#00d6d6',fill:!1},{label:window.rcstats.i18n.msg('users').plain(),data:daysUsersData,backgroundColor:'#ff6a64',borderColor:'#ff6a64',fill:!1}],labels:daysLabels}},getPagesChartData:function(editsByType){var typeEditsMinor=[]
var typeEditsMajor=[]
var typeEditsLabels=[]
Object.entries(editsByType).sort(function(a,b){return b[1].major+b[1].minor-(a[1].major+a[1].minor)}).forEach(function(e){typeEditsMinor.push(e[1].minor)
typeEditsMajor.push(e[1].major)
typeEditsLabels.push(window.rcstats.i18n.msg(e[0]).plain())})
var datasets=[{label:window.rcstats.i18n.msg('edits').plain(),data:typeEditsMajor,backgroundColor:'#006661'}]
if(typeEditsMinor.some(function(v){return v>0})){datasets.push({label:window.rcstats.i18n.msg('minorEdits').plain(),data:typeEditsMinor,backgroundColor:'#5df2ae'})}return{datasets:datasets,labels:typeEditsLabels}},updateCharts:function(data,usersFilter){var dicts=window.rcstats.getEditDicts(data)
var results={users:window.rcstats.getUsersChartData(dicts.editsByUsers,usersFilter),days:window.rcstats.getDaysChartData(dicts.editsByDays),pages:window.rcstats.getPagesChartData(dicts.editsByType)}
Object.entries(results).forEach(function(chart){var previous=JSON.stringify(window.rcstats.charts[chart[0]].data.datasets.map(function(o){return Object.entries(o).find(function(e){return e[0]==='data'})[1]}))
var current=JSON.stringify(chart[1].datasets.map(function(o){return Object.entries(o).find(function(e){return e[0]==='data'})[1]}))
if(previous!==current){window.rcstats.charts[chart[0]].data.datasets=chart[1].datasets
window.rcstats.charts[chart[0]].data.labels=chart[1].labels
window.rcstats.charts[chart[0]].update()}})
window.rcstats.updateFooter(data)},updateFilter:function(){var enabledTypes=[]
Array.from(document.querySelectorAll('.rcfilters input[type=checkbox][data-type]')).forEach(function(elem){if(elem.checked){enabledTypes.push(elem.getAttribute('data-type'))}})
var botsEnabled=(document.querySelector('.rcfilters input[type=checkbox][data-bots]')||{}).checked
var minorEnabled=(document.querySelector('.rcfilters input[type=checkbox][data-minor]')||{}).checked
window.rcstats.updateCharts(window.rcstats.data.filter(function(e){if((!botsEnabled&&e.bot)||(!minorEnabled&&e.minor)){return false}return enabledTypes.includes(e.type)}))},updateFooter:function(data){if(!data[0]){document.querySelector('.rcfooter').textContent=window.rcstats.i18n.msg('nodata').plain()}else{document.querySelector('.rcfooter').textContent=window.rcstats.i18n.msg('footer',data.length,Math.ceil((new Date().getTime()-data[0].timestamp.getTime())/(1000*60*60*24))).plain()}},isStatsPage:function(){return mw.config.get('wgCanonicalSpecialPageName')==='Blankpage'&&new URLSearchParams(window.location.search).get('blankspecial')==='rcstats'},charts:{users:null,days:null,pages:null},data:[]}
if(document.readyState!=='loading'){window.rcstats.onLoad()}else{document.addEventListener('DOMContentLoaded',function(){window.rcstats.onLoad()})}}})();(function(){if(!$('#userIdentityBoxEdit').exists()||window.EditBioLoaded){return;}window.EditBioLoaded=!0;var username=$('.masthead-info h1[itemprop="name"]').text();if(!window.dev||!window.dev.i18n){importArticle({type:'script',article:'u:dev:MediaWiki:I18n-js/code.js'});}importArticle({type:'style',article:'u:dev:MediaWiki:EditBio.css'});var i18n,userdata;function saveError(res){console.error(res);}function saveBio(){$.ajax({type:'PUT',url:'https://services.fandom.com/user-attribute/user/'+userdata.id+'/attr/bio',data:{value:$('#edit-bio-form #edit-bio-content').val()},xhrFields:{withCredentials:!0},error:saveError,success:clearCache});}function closeModal(){$('#edit-bio-form').closeModal();}function cacheCallback(res){if(res.status==='ok'){closeModal();setTimeout(refreshMasthead,500);}else{console.error(res);}}function clearCache
(){$.nirvana.postJson('UserProfilePage','saveUserData',{userId:userdata.id,data:JSON.stringify({birthday:userdata.birthday}),token:mw.user.tokens.get('editToken')},cacheCallback);}function refreshMasthead(){window.location.reload();}function editBio(){var bio=userdata.bio||'',modalContent=$('<div>').append($('<textarea>',{id:'edit-bio-content',rows:bio.split('\n').length,text:bio}));if(username!==mw.config.get('wgUserName')){modalContent.prepend($('<p>').append($('<strong>').text(i18n.msg('caution').plain()),':&nbsp;',i18n.msg('foreign-bio-edit').escape()));}$.showCustomModal(i18n.msg('edit').escape(),modalContent.html(),{id:'edit-bio-form',buttons:[{message:i18n.msg('cancel').escape(),handler:closeModal,id:'edit-bio-cancel'},{message:i18n.msg('save').escape(),handler:saveBio,defaultButton:!0,id:'edit-bio-save'}]});}function init(i18nd,nirvana){i18n=i18nd;if(nirvana[0]&&nirvana[0].user){userdata=nirvana[0].user;$('.WikiaUserPagesHeader .details ul').append($('<div>',{text:'['+i18n.
msg('edit').plain()+']',id:'edit-bio-button',click:editBio}));}}function nirvana(){return $.nirvana.getJson('UserProfilePage','renderUserIdentityBox',{title:'User:'+username});}function i18nCallback(i18no){$.when(i18no.loadMessages('EditBio'),nirvana()).then(init);}mw.hook('dev.i18n').add(i18nCallback);})();;mw.hook('wikipage.content').add(function($content){$content.find('.youtubeplayer:not(.loaded)').each(function(){var $this=$(this),data=$this.data(),uri=new mw.Uri('https://www.youtube.com/embed/'),id=String(data.id||'').trim(),loop=String(data.loop||'').trim();if(id===''){console.warn('[YoutubePlayer] Video ID is not defined.');return;}uri.path+=id;uri.query={autoplay:window.YoutubePlayerDisableAutoplay?'0':String(data.autoplay||'').trim(),loop:loop,playlist:loop==='1'?id:'',start:String(data.start||'').trim(),list:String(data.list||'').trim()};$this.html($('<iframe>',{width:String(data.width||'').trim(),height:String(data.height||'').trim(),src:uri.toString(),allowfullscreen:
'true',allow:'fullscreen'+(loop?'; autoplay':'')})).addClass('loaded');});});;;mw.loader.state({"wikia.fake.articles.a69313c659bc2a9799706901848502f0":"ready"});

/* cache key: espokemon:resourceloader:filter:minify-js:7:8f71f0d4d671728d89e3d0f69981d2ac */